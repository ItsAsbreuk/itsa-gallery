YUI.add("gallery-itsadialog",function(e,t){"use strict";function m(){m.superclass.constructor.apply(this,arguments)}var n=e.Array,r=e.Lang,i=5e3,s="boolean",o="model",u="title",a="footer",f="info",l="warn",c="error",h="value",p="itsa-dialog",d="escape:hide",v="visible";m.NAME="itsadialog",e.extend(m,e.ITSAMessageViewer),m.prototype.initializer=function(){var t=this;t._eventhandlers=[],e.later(i,t,t.renderPromise)},m.prototype.renderPromise=function(){var t=this;return t._renderPromise||(t._renderPromise=e.usePromise("gallery-itsaviewmodelpanel").then(e.bind(t._renderPanels,t)))},m.prototype._renderPanels=function(){var t=this,n={visible:!1,centered:!0,modal:!0,editable:!0,minWidth:200,dragable:!0,maxWidth:550,className:p},r=t._eventhandlers,i;i=t.panels={},i[f]=new e.ITSAViewModelPanel(n),i[l]=new e.ITSAViewModelPanel(n),i[c]=new e.ITSAViewModelPanel(n),r.push(i[f].after("*:hide",function(e){var t=e.target,n=t.get(o),r=e.buttonNode,i=r&&r.get(h),s=n.rejectButton,u=e.type===d||s&&(new RegExp("btn_"+i+"$")).test(s);u?n.rejectPromise(i):n.UIToModel()&&n._set("button",i)&&n.resolvePromise(n.toJSON())})),r.push(i[f].after("*:submit",function(t){var n=t.target,r=t.parsed;console.log(e.Object.keys(r)),n.UIToModel()&&n.resolvePromise(n.toJSON())})),r.push(i[l].after("*:hide",function(e){var t=e.target,n=t.get(o),r=e.buttonNode,i=r&&r.get(h),s=n.rejectButton,u=s&&(new RegExp("btn_"+i+"$")).test(s);u?n.rejectPromise(i):n.UIToModel()&&n._set("button",i)&&n.resolvePromise(n.toJSON())})),r.push(i[c].after("*:hide",function(e){var t=e.target,n=t.get(o),r=e.buttonNode,i=r&&r.get(h),s=n.rejectButton,u=s&&(new RegExp("btn_"+i+"$")).test(s);u?n.rejectPromise(i):n.UIToModel()&&n._set("button",i)&&n.resolvePromise(n.toJSON())})),i[f].render(),i[l].render(),i[c].render()},m.prototype.viewMessage=function(t){var n=this;return n.renderPromise().then(function(){return new e.Promise(function(i){var h=t.level,p=t.primaryButton,d=t.rejectButton,m=n.panels,g=m[h],y=t.buttonLabels,b=t.hotKeys,w=t.customBtns,E=t.noButtons,S=typeof t.noHideOnSubmit===s?t.noHideOnSubmit:!1,x=t[a],T=/btn_/.test(x),N,C;m[f].hide(),m[l].hide(),m[c].hide(),g=m[h],g.set("noHideOnSubmit",S),g.removeButtonLabel(),g.removeCustomBtn(),g.removeHotKey(),g.set("closeButton",!T&&!E),g.set("closableByEscape",typeof d=="string"),g.set(a+"Template",E?null:x),y&&g.setButtonLabels(y),b&&g.setHotKeys(b),w&&g.addCustomBtns(w),!E&&x&&r.isValue(p)&&(N=g.get("footerView"),C=typeof p=="boolean"&&!p,C?N.removePrimaryButton():N.setPrimaryButton(p)),g.set(u,t[u]),g.set(o,t),g.set("template",t.message),t.promise.then(function(){return g.set(v,!1,{silent:!0})},function(){return g.set(v,!1,{silent:!0})}).then(i).then(null,function(t){e.soon(function(){throw t})}),g.show()})})},m.prototype.resurrect=function(e){var t=this;t.renderPromise().then(function(){var n=t.panels[e];n&&n.show()})},m.prototype.destructor=function(){var e=this.panels;this._clearEventhandlers(),e[f].destroy(),e[l].destroy(),e[c].destroy()},m.prototype._clearEventhandlers=function(){var e=this;n.each(e._eventhandlers,function(e){e.detach()})},e.Global.ITSADialog||(e.Global.ITSADialog=new m({handleAnonymous:!0})),e.ITSADialog=e.Global.ITSADialog},"@VERSION@",{requires:["yui-base","promise","event-custom-base","yui-later","oop","gallery-itsaviewmodelpanel","gallery-itsamodulesloadedpromise","gallery-itsamessageviewer"],skinnable:!0});
