YUI.add("gallery-itsadialog",function(e,t){"use strict";function U(){U.superclass.constructor.apply(this,arguments)}var n=e.Array,r=e.Lang,i=335,s=5e3,o=4e3,u='<i class="itsa-dialogicon {icon}"></i>',a="_suspended",f="boolean",l="string",c="number",h="model",p="title",d="footer",v="info",m="warn",g="error",y="value",b="uppercase",w="lowercase",E="capitalize",S="fadeDelay",x="itsa",T=x+"-focussed",N="dialog",C=x+N,k=x+"-"+N,L="escape:hide",A="visible",O="itsa-panelclosebtn",M="closebutton",_="btn_",D="button",P="Change",H="Transform",B=D+H,j="label"+H,F="up",I=k+v+F,q=k+m+F,R=k+g+F;U.NAME="itsadialog",e.ITSADialogClass=e.extend(U,e.ITSAMessageViewer,{},{ATTRS:{buttonTransform:{value:null,validator:function(e){return e===null||e===b||e===w||e===E}},fadeDelay:{value:.1,validator:function(e){return typeof e===c&&e>=0}},labelTransform:{value:null,validator:function(e){return e===null||e===b||e===w||e===E}},showIcon:{value:!0,validator:function(e){return typeof e===f}}}}),U.prototype.initializer=function(){var t=this;t._eventhandlers=[],t._body=e.one("body"),t._panels={},t._viewName=C,e.later(s,t,t.isRendered)},U.prototype.isRendered=function(){var t=this;return t._renderPromise||(t._renderPromise=e.usePromise("gallery-itsaviewmodelpanel","gallerycss-itsa-dialog","gallerycss-itsa-form").then(e.bind(t._renderPanels,t)))},U.prototype.resurrect=function(e){var t=this;t.isRendered().then(function(){var n=t._panels[e.level],r;console.log("resurrect"),n&&(console.log("resurrect: panel found"),n.set(A,!0,{transconfig:{duration:t.get(S)}}))})},U.prototype.suspend=function(e){var t=this;t.isRendered().then(function(){var n=t._panels[e.level];n&&n.set(A,!1,{silent:!0})})},U.prototype.viewMessage=function(t){var n=this;return n.isRendered().then(function(){return new e.Promise(function(r){var i=n._panels,s=i[t.level];n._showPanel(s,t),t._promise.then(function(){return s.set(A,!1,{silent:!0})},function(){return s.set(A,!1,{silent:!0})}).then(r).then(null,function(t){e.soon(function(){throw t})})})})},U.prototype.destructor=function(){var e=this._panels;this._clearEventhandlers(),e[v].destroy(),e[m].destroy(),e[g].destroy()},U.prototype._clearEventhandlers=function(){var e=this;n.each(e._eventhandlers,function(e){e.detach()})},U.prototype._renderPanels=function(){var t=this,r={visible:!1,centered:!0,modal:!0,editable:!0,minWidth:i,dragable:!0,maxWidth:550,buttonTransform:t.get(B),labelTransform:t.get(j),className:k},s=t._panels,o=t._eventhandlers,u,a,f;u=s[v]=new e.ITSAViewModelPanel(r),a=s[m]=new e.ITSAViewModelPanel(r),f=s[g]=new e.ITSAViewModelPanel(r),n.each([v,m,g],function(e){o.push(s[e].after("*:hide",function(e){var t=e.target,n=t.get(h),r=e.buttonNode,i=r&&r.get(y),s=n.rejectButton,o=r&&r.hasClass(O)&&(i=M),u=e.type===L||o||s&&(new RegExp(_+i+"$")).test(s);n.UIToModel(),n._set(D,i),u?n.reject(i):n.resolve(n.toJSON())}))}),o.push(t.on(j+P,function(e){var t=e.newVal;u.set(j,t),a.set(j,t),f.set(j,t)})),o.push(t.on(B+P,function(e){var t=e.newVal;u.set(B,t),a.set(B,t),f.set(B,t)})),o.push(u.on(A+P,function(e){t._body.toggleClass(I,e.newVal)})),o.push(a.on(A+P,function(e){t._body.toggleClass(q,e.newVal)})),o.push(f.on(A+P,function(e){t._body.toggleClass(R,e.newVal)})),u.render(),a.render(),f.render()},U.prototype._showPanel=function(e,t){var n=this,i=t.primaryButton,s=t.rejectButton,o=t.buttonLabels,c=t.hotKeys,v=t.customBtns,m=t.noButtons,g=t.closeButton,y=typeof t.noHideOnSubmit===f?t.noHideOnSubmit:!1,b=t[d],w=/btn_/.test(b),E=t.icon,x=E&&n.get("showIcon"),T,N;e.set("noHideOnSubmit",y),e.removeButtonLabel(),e.removeCustomBtn(),e.removeHotKey(),e.set("closeButton",typeof g===f?g:!w&&!m),e.set("closableByEscape",typeof s===l),e.set(d+"Template",m?null:b),o&&e.setButtonLabels(o),c&&e.setHotKeys(c),v&&e.addCustomBtns(v),!m&&b&&r.isValue(i)&&(T=e.get("footerView"),N=typeof i=="boolean"&&!i,N?T.removePrimaryButton():T.setPrimaryButton(i)),e.set(p,t[p]),e.set(h,t),e._body.toggleClass("itsa-hasicon",x),e.set("template",(x?r.sub(u,{icon:E}):"")+t.message),t[a]||e.show({duration:n.get(S)})},e.Global.ITSADialog||(e.Global.ITSADialog=new U),e.ITSADialog=e.Global.ITSADialog},"@VERSION@",{requires:["yui-base","promise","node-core","event-custom-base","yui-later","timers","oop","gallery-itsaviewmodelpanel","gallery-itsamodulesloadedpromise","gallery-itsamessageviewer"],skinnable:!0});
