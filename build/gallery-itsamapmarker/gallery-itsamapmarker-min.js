YUI.add("gallery-itsamapmarker",function(e,t){"use strict";e.ITSAMapMarker=e.Base.create("itsamapmarker",e.Base,[],{TILE_SIZE:256,initializer:function(){var t=this;t.get("markerid")||t.set("markerid",e.guid())},render:function(t){var n=this;n.renderUI(),e.on("contentready",function(e){var t=this;t.bindUI(),t.syncUI(e)},"#marker_"+n.get("markerid"),n,t)},renderUI:function(){var e,t,n;e=this,t=e.get("host"),n="<div id='marker_"+e.get("markerid")+"' class='cmasmapmarker'><div class='cmasmapmarkercontent'></div>"+"<div class='cmasmapmarkerclickarea'></div><div class='cmasmapmarkerinfo cmasnodisplay'><div class='cmasmapmarkerinfocontent'></div>"+"<div class='cmasmapmarkerinfoclose'>x</div><div class='cmasmapmarkerinfolabel'></div></div></div>",t.appendChild(n)},bindUI:function(){var t,n,r,i,s;t=this,n=e.one("#marker_"+t.get("markerid")),i=n.one(".cmasmapmarkerinfoclose"),s=n.one(".cmasmapmarkerclickarea"),i&&i.on("click",t._hideInfoByEvent,t),r=t.get("onclick"),r&&s&&(s.on("click",r),s.setStyle("cursor","help"))},syncUI:function(t){var n,r,i,s,o,u,a,f,l,c,h,p=18,d,v,m,g;n=this,r=e.one("#marker_"+n.get("markerid")),i=r.one(".cmasmapmarkercontent"),s=r.one(".cmasmapmarkerinfocontent"),t||(t=n._getZoomLevel()),r.setStyle("left",n._getX(t)+"px"),r.setStyle("top",n._getY(t)+"px");switch(this.get("size")){case 0:r.addClass("markersizelarge"),r.removeClass("markersizemedium"),r.removeClass("markersizesmall");break;case 1:r.removeClass("markersizelarge"),r.addClass("markersizemedium"),r.removeClass("markersizesmall");break;case 2:r.removeClass("markersizelarge"),r.removeClass("markersizemedium"),r.addClass("markersizesmall")}n.get("selected")?r.addClass("markerstatusselected"):r.removeClass("markerstatusselected"),o=parseInt(n.get("status"),10),v=n.get("forcedMarkerColor"),v?(r.removeClass("markerstatusmanipulated"),r.removeClass("markerstatuserror"),r.removeClass("markerstatusmotion"),r.removeClass("markerstatusforced1"),r.removeClass("markerstatusforced2"),r.removeClass("markerstatusforced3"),r.removeClass("markerstatusforced4"),r.removeClass("markerstatusforced5"),r.removeClass("markerstatusforced6"),m=(v-1)%6+1,r.addClass("markerstatusforced"+m)):o===4?(r.addClass("markerstatusmanipulated"),r.removeClass("markerstatuserror"),r.removeClass("markerstatusmotion")):(r.removeClass("markerstatusmanipulated"),n.get("error")||o===2||o===3?(r.addClass("markerstatuserror"),r.removeClass("markerstatusmotion")):(r.removeClass("markerstatuserror"),o===1?r.addClass("markerstatusmotion"):r.removeClass("markerstatusmotion"))),i.setContent(n.get("markerText")),c=n.get("position"),a=n.get("accu"),f=n.get("md1"),l=n.get("md2"),g=n.get("title"),g&&g!==""?u='<span class="clicktrace-markerhead">'+g+"</span>":u='<span class="clicktrace-markerhead">Marker '+n.get("markerText")+"</span>",u+="<br>"+n.get("gmt"),c&&c.length>0&&(c.length>p?h=c.substring(0,p)+"...":h=c,u+="<br>"+h),u+="<br>Battery: "+n.get("battery")+"%",a&&a.length>0&&(a=parseInt(a,10)/10,u+="<br>Accu: "+a+" Volt"),u+="<br>GSM: "+n.get("gsm")+"%",u+="<br>Status: "+n.get("status"),u+="<br>Speed: "+n.get("speed")+" km/u",d=Math.round(parseInt(n.get("distance"),10)/100)/10,u+="<br>Distance: "+d+" km",f&&f.length>0&&(u+="<br>Mode 1: "+f),l&&l.length>0&&(u+="<br>Mode 2: "+l),s.setContent(u),r.setStyle("visibility","inherit")},showMarker:function(){var t,n;t=this,n=e.one("#marker_"+t.get("markerid")),n.removeClass("cmasnodisplay")},hideMarker:function(){var t,n;t=this,n=e.one("#marker_"+t.get("markerid")),n.addClass("cmasnodisplay")},showInfo:function(){var t,n,r;t=this,n=e.one("#marker_"+t.get("markerid")),r=n.one(".cmasmapmarkerinfo"),r.removeClass("cmasnodisplay")},hideInfo:function(){var t,n,r;t=this,n=e.one("#marker_"+t.get("markerid")),r=n.one(".cmasmapmarkerinfo"),r.addClass("cmasnodisplay")},_hideInfoByEvent:function(e){var t=this;e.stopPropagation(),t.hideInfo()},_getZoomLevel:function(){var e,t,n,r;return e=this,t=e.get("host"),r=t.get("parentNode"),n=parseInt(r.get("id").substring(8,10),10),n},_getX:function(e){var t=this,n=t._long2tileNOTROUNDED(t.get("lon"),e),r=Math.round((n-1)*t.TILE_SIZE);return r-t.get("xOffsetMarker")},_getY:function(e){var t=this,n=t._lat2tileNOTROUNDED(t.get("lat"),e),r=Math.round((n-1)*t.TILE_SIZE);return r-t.get("yOffsetMarker")},_long2tileNOTROUNDED:function(e,t){return(e+180)/360*Math.pow(2,t)},_lat2tileNOTROUNDED:function(e,t){return(1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*Math.pow(2,t)},destructor:function(){var t,n;t=this,n=e.one("#marker_"+t.get("markerid")),n.remove(!0)}},{ATTRS:{host:{value:null},markerid:{value:null},zIndex:{setter:function(t){var n=this.get("markerid"),r;return n&&(r=e.one("#marker_"+n),r&&r.setStyle("zIndex",t)),t},validator:function(t){return e.Lang.isNumber(t)}},markerSet:{value:"http://brongegevens.cmas2plus.nl/global/images/markers1.png"},xOffsetMarker:{value:10,validator:e.Lang.isNumber},yOffsetMarker:{value:35,validator:e.Lang.isNumber},defaultMarker:{value:1},showOnMouseover:{value:!1},shadow:{value:!1},labelSymbol:{value:!0},width:{value:200},height:{value:500},autoHeight:{value:!1},overflow:{value:"scroll"},title:{value:""},body:{value:""},lat:{value:52.149},lon:{value:5.645},position:{value:""},size:{value:1},markerText:{value:""},status:{value:0},gmt:{value:""},battery:{value:0},accu:{value:""},gsm:{value:0},speed:{value:0},distance:{value:0},md1:{value:""},md2:{value:""},selected:{value:!1},forcedMarkerColor:{value:null},showInfo:{value:!1,setter:function(e){return e?this.showInfo():this.hideInfo(),e},validator:function(t){return e.Lang.isBoolean(t)}},error:{value:!1},onclick:{value:null}}})},"@VERSION@",{requires:["widget","base-build","event"],skinnable:!0});
