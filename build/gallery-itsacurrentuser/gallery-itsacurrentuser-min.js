YUI.add("gallery-itsacurrentuser",function(e,t){"use strict";function u(){u.superclass.constructor.apply(this,arguments)}var n=e.Array,r="logged",i=r+"in",s=r+"out",o="string";u.NAME="itsacurrentuser",e.ITSACurrentUserClass=e.extend(u,e.Model),u.prototype.username=null,u.prototype.password=null,u.prototype.remember=null,u.prototype.displayname=null,u.prototype.messageLoggedin=null,u.prototype._isLoggedin=!1,u.prototype.initializer=function(){var t=this,n=t._eventhandlers=[];n.push(e.after(i,function(e){var n=e.username,r=e.password,i=e.remember||!1,s=e.displayname,u=e.messageLoggedin,a=e.userdata;typeof n===o&&typeof r===o&&n.length>0&&r.length>0?t.dologin(n,r,i,s,u,a):t.dologout()})),n.push(e.after(s,e.bind(t.dologout,t))),t._isReady=new e.Promise(function(e){t._loadUser().then(e,e)})},u.prototype.dologin=function(e,t,n,r,i,s){var o=this;return o.username=e,o.password=t,o.remember=n,o.displayname=r,o.messageLoggedin=i,o.setAttrs(s),o._isLoggedin=!0,n?o._saveUser():o._clearUser()},u.prototype.dologout=function(){var e=this;return e.reset(),e.set("id",undefined),e._isLoggedin=!1,e._clearUser()},u.prototype.isLoggedin=function(){var e=this;return e.isReady().then(function(){if(!e._isLoggedin)throw new Error("not loggedin");return{username:e.username,password:e.password,remember:e.remember,displayname:e.displayname,messageLoggedin:e.messageLoggedin,userdata:e.toJSON()}})},u.prototype.isReady=function(){return this._isReady},u.prototype.destructor=function(){this._clearEventhandlers()},u.prototype._clearEventhandlers=function(){n.each(this._eventhandlers,function(e){e.detach()})},u.prototype._clearUser=function(){return new e.Promise(function(e){e()})},u.prototype._loadUser=function(){var t=this;return new e.Promise(function(e){t._isLoggedin=!1,e()})},u.prototype._saveUser=function(){return new e.Promise(function(e){e()})},e.ITSACurrentUser=new e.ITSACurrentUserClass},"@VERSION@",{requires:["yui-base","promise"]});
