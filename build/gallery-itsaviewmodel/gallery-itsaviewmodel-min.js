YUI.add("gallery-itsaviewmodel",function(e,t){"use strict";var n=e.Lang,r=e.Array,i=e.Template.Micro,s="itsa-modelview-styled";e.ITSAViewModel=e.Base.create("itsaviewmodel",e.Widget,[],{view:null,_modelTemplate:null,_eventhandlers:[],initializer:function(){var t=this,n=t.get("boundingBox"),r=t.get("contentBox"),i=t.get("events"),o=t.get("model"),u=t.get("template"),a=t.get("styled"),f;a&&n.addClass(s),f=t.view=new e.View({container:r,model:o}),f.events=i,f.template=u,t._setTemplateRenderer(u),f.render=e.rbind(t._viewRenderer,t),o&&o.addTarget&&o.addTarget(f)},bindUI:function(){var t=this,n=t.get("boundingBox"),r=t._eventhandlers,i=t.view;r.push(t.after("modelChange",function(e){var t=e.prevVal,n=e.newVal;t&&t.removeTarget&&t.removeTarget(i),n&&n.addTarget&&n.addTarget(i),i.set("model",n),i.render()})),r.push(t.after("templateChange",function(e){var n=e.newVal;i.template=n,t._setTemplateRenderer(n),i.render()})),r.push(t.after("eventsChange",function(e){i.events=e.newVal})),r.push(t.after("styledChange",function(e){n.toggleClass(s,e.newVal)})),r.push(i.after("*:change",e.bind(i.render,i))),r.push(i.after("model:destroy",e.rbind(i.render,i,!0)))},syncUI:function(){this.view.render()},destructor:function(){var e=this;e._clearEventhandlers(),e.view.destroy()},_getModelToJSON:function(e){return e.get&&n.type(e.get)==="function"?e.toJSON():e},_setTemplateRenderer:function(e){var t=this,r,s;r=function(){var t=/<%(.+)%>/;return t.test(e)},r()?(s=i.compile(e),t._modelTemplate=function(e){return s(t._getModelToJSON(e))}):t._modelTemplate=function(r){return n.sub(e,t._getModelToJSON(r))}},_viewRenderer:function(e){var t=this,n=t.view,r=n.get("container"),i=n.get("model"),s=e?"":t._modelTemplate(i);return r.setHTML(s),t},_clearEventhandlers:function(){r.each(this._eventhandlers,function(e){e.detach()})}},{ATTRS:{events:{value:{},validator:function(e){return n.isObject(e)}},model:{value:null,validator:function(t){return t instanceof e.Model||n.isObject(t)||t===null}},styled:{value:!0,validator:function(e){return n.isBoolean(e)}},template:{value:"{clientId}",validator:function(e){return n.isString(e)}}}})},"@VERSION@",{requires:["base-build","widget","view","template-micro","model"],skinnable:!0});
