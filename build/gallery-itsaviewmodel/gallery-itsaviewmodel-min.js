YUI.add("gallery-itsaviewmodel",function(e,t){"use strict";function it(){}var n,r=e.Lang,i=e.Array,s=e.Intl,o=e.Template.Micro,u="gallery-",a="itsaviewmodel",f="button",l="model",c="Save",h="cancel",p="Submit",d="Load",v="Destroy",m="Reset",g="Promise",y="destroyed",b="_defFn_",w="boolean",E="string",S="function",x="editable",T="container",N="cancel",C="destroy",k="remove",L="load",A="reset",O="save",M="submit",_="date",D="time",P="picker",H="click",B="btn_",j=B+N,F=B+C,I=B+k,q=B+A,R=B+O,U=B+L,z=B+M,W="focusnext",X="validationerror",V="uichanged",$=f+H,J=C+H,K=k+H,Q=L+H,G=M+H,Y=N+H,Z=A+H,et=O+H,tt=_+P+H,nt=D+P+H,rt=_+D+P+H;e.mix(it.prototype,{cleanupWidgets:function(t){var n=this,r=e.Widget;r&&n.all(".yui3-widget").each(function(e){if(n.one("#"+e.get("id"))){var i=r.getByNode(e);i&&i.destroy(t)}})},cleanup:function(){var e=this;e.cleanupWidgets(!0),e.empty()}},!0),e.Node.ITSANodeCleanup=it,e.Base.mix(e.Node,[it]),n=e.ITSAViewModel=e.Base.create(a,e.View,[],{},{ATTRS:{editable:{value:!1,validator:function(e){return typeof e===w},getter:function(e){var t=this.get(l);return e&&t&&t.toJSONUI}},model:{value:{},validator:function(e){return e===null||r.isObject(e)||typeof e===E||e.get&&typeof e.get===S&&e.get("clientId")},setter:"_setModel"},template:{value:null,validator:function(e){return typeof e===E},getter:function(e){var t=this;return t._textTemplate||e||t._intl.undefined_template}}}}),n.prototype._validBtnTypes={cancel:!0,destroy:!0,remove:!0,reset:!0,save:!0,submit:!0,load:!0},n.prototype.initializer=function(){var t=this,n=t.get(l);i.each([Y,J,K,Z,et,G,$,Q,rt,tt,nt,X,V],function(n){t["_defPrevFn_"+n]=function(e){e.modelEventFacade.preventDefault()},t.publish(n,{preventedFn:e.bind(t["_defPrevFn_"+n],t),emitFacade:!0})}),t.publish(W,{defaultFn:e.bind(t[b+W],t),emitFacade:!0}),t._isMicroTemplate=null,t._modelRenderer=null,t._eventhandlers=[],t._textTemplate=null,t._setTemplateRenderer(t.get(x)),n&&n.addTarget&&n.addTarget(t),t._intl=s.get(u+a),t._customBtnLabels={},t._createButtons()},n.prototype.removeButtonLabel=function(e){delete this._customBtnLabels[e]},n.prototype.render=function(t){var n=this,r=n.get(T),i=r.itsatabkeymanager,s=n.get(l),o=n.get(x),f=e.Global.ItsaDateTimePicker,c=t||!s?"":n._modelRenderer(s);if(o||n._isMicroTemplate)o&&(n._initialEditAttrs=s.getAttrs()),r.cleanupWidgets(!0);return n._rendered||(r.inDoc()||e.one("body").append(r),r.addClass(a),n._bindUI()),n._rendered=!0,r.setHTML(c),o&&e.use(u+"itsatabkeymanager",function(){i?i.refresh(r):(r.plug(e.Plugin.ITSATabKeyManager),i=r.itsatabkeymanager),n.get("focused")&&i.focusInitialItem()}),f&&f.panel.get("visible")&&f.hide(!0),n.fire("viewrendered",{target:n}),n},n.prototype.setButtonLabel=function(e,t){var n=this;n._validBtnTypes[e]&&typeof t===E&&t.length>0&&(n._customBtnLabel[e]=t)},n.prototype.toJSON=function(){var t=this.get(l);return t instanceof e.Model?t.toJSON():t},n.prototype.destructor=function(){var e=this,t=e.get(l),n=e.get(T);t&&t.removeTarget&&t.removeTarget(e),e._clearEventhandlers(),n.hasPlugin("itsatabkeymanager")&&n.unplug("itsatabkeymanager")},n.prototype._bindUI=function(){var t=this,n=t.get(T),r=t._eventhandlers;r.push(t.after("modelChange",function(e){var n=e.prevVal,r=e.newVal,i=n&&n.toJSONUI,s=r&&r.toJSONUI;n&&n.removeTarget&&n.removeTarget(t),r&&r.addTarget&&r.addTarget(t),i!==s&&t._setTemplateRenderer(t.get("template"),s&&t.get(x)),t.render()})),r.push(t.after("templateChange",function(){t._setTemplateRenderer(t.get(x)),t.render()})),r.push(t.after("*:resetclick",function(){var e=n.itsatabkeymanager;t._isMicroTemplate&&t.render(),e&&e.focusInitialItem()})),r.push(t.after("editableChange",function(e){var n=e.newVal,r=t.get(l);r&&r.toJSONUI&&(t._setTemplateRenderer(n),t.render())})),r.push(t.after("*:change",function(n){n.target instanceof e.Model&&!t.get(x)&&t.render()})),r.push(t.after("*:destroy",function(e){e.target!==t&&t.render(!0)})),r.push(e.Intl.after("intl:langChange",function(){t._intl=e.Intl.get(u+a)})),i.each([N,C,k,A,O,M,L,Y,J,K,Z,et,G,$,Q,rt,tt,nt,X,V,W],function(e){r.push(t.on("*:"+e,function(n){var r;n.target!==t&&(t._validBtnTypes[e]&&(e=l+e),r={type:e,model:t.get(l),modelEventFacade:n,target:t,value:n.value,node:n.node,nodeid:n.nodeid,formElement:n.formElement},t.fire(e,r))}))})},i.each([c,h,p,d,v,m],function(t){n.prototype[l+t]=function(){var n=this,r=n.get(l);r instanceof e.Model&&!r.get(y)&&r[b+t]&&r[b+t]()}}),i.each([c,p,d,v],function(t){n.prototype[l+t+g]=function(){var n=this,r=n.get(l),i=t.toLowerCase();return r instanceof e.Model&&!r.get(y)&&r[i+g]||null}}),n.prototype._clearEventhandlers=function(){i.each(this._eventhandlers,function(e){e.detach()})},n.prototype._createButtons=function(){var e=this,t=e._customBtnLabels;e._buttons=[{propertykey:j,type:N,labelHTML:t[N]?r.sub(t[N],{label:e._intl[N]}):e._intl[N]},{propertykey:F,type:C,labelHTML:t[C]?r.sub(t[C],{label:e._intl[C]}):e._intl[C]},{propertykey:I,type:k,labelHTML:t[k]?r.sub(t[k],{label:e._intl[k]}):e._intl[k]},{propertykey:q,type:A,labelHTML:t[A]?r.sub(t[A],{label:e._intl[A]}):e._intl[A]},{propertykey:R,type:O,labelHTML:t[O]?r.sub(t[O],{label:e._intl[O]}):e._intl[O]},{propertykey:U,type:L,labelHTML:t[L]?r.sub(t[L],{label:e._intl[L]}):e._intl[L]},{propertykey:z,type:M,labelHTML:t[M]?r.sub(t[M],{label:e._intl[M]}):e._intl[M]}]},n.prototype[b+W]=function(){var e=this,t=e.get(T),n=t&&t.itsatabkeymanager;n&&n.next()},n.prototype._setModel=function(e){var t=this;return typeof e===E?(t._textTemplate=e,e={}):t._textTemplate=null,e},n.prototype._setTemplateRenderer=function(t){var n=this,s=n.get("template"),u,a,f,l;u=function(){var e=/<%(.+)%>/;return e.test(s)},l=function(t,r){var s,o,u,a;i.each(n._buttons,function(n){s=n.propertykey,o=n.type,u=n.labelHTML,a=n.config,t[s]=e.bind(r._renderBtnFns[o],r,u,a)()})},a=n._isMicroTemplate=u(),a?(f=o.compile(s),n._modelRenderer=function(e){var r=t?e.toJSONUI():n.toJSON();return e.toJSONUI&&l(r,e),f(r)}):n._modelRenderer=function(e){var i=t?e.toJSONUI():n.toJSON();return e.toJSONUI&&
l(i,e),r.sub(s,i)}}},"@VERSION@",{requires:["intl","base-build","view","template-micro","model","event-custom","pluginhost-base"],lang:["ar","de","en","es","fr","hu","it","ja","nb","nl","pt","ru","zh"],skinnable:!0});
