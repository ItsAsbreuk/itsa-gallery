YUI.add("gallery-itsaviewmodel",function(e,t){"use strict";function Dt(){}var n,r=e.Lang,i=e.Array,s=e.Object,o=e.Intl,u="itsabutton-iconleft",a='<i class="itsaicon-form-{type}"></i>',f=e.Template.Micro,l="gallery-",c="itsaviewmodel",h="button",p="model",d="Save",v="Submit",m="Load",g="Destroy",y="Reset",b="Promise",w="destroyed",E="_defFn_",S="boolean",x="string",T="function",N="editable",C="container",k={destroy:!0,remove:!0,reset:!0,save:!0,submit:!0,load:!0},L={button:!0,destroy:!0,remove:!0,reset:!0,save:!0,submit:!0,load:!0},A={btn_abort:!0,btn_cancel:!0,btn_destroy:!0,btn_ignore:!0,btn_load:!0,btn_no:!0,btn_ok:!0,btn_remove:!0,btn_reset:!0,btn_retry:!0,btn_save:!0,btn_submit:!0,btn_yes:!0,imgbtn_abort:!0,imgbtn_cancel:!0,imgbtn_destroy:!0,imgbtn_ignore:!0,imgbtn_load:!0,imgbtn_no:!0,imgbtn_ok:!0,imgbtn_remove:!0,imgbtn_reset:!0,imgbtn_retry:!0,imgbtn_save:!0,imgbtn_submit:!0,imgbtn_yes:!0,spinbtn_load:!0,spinbtn_remove:!0,spinbtn_save:!0,spinbtn_submit:!0,spinbtn_yes:!0},O="destroy",M="remove",_="load",D="reset",P="save",H="submit",B="click",j="abort",F="cancel",I="ignore",q="no",R="ok",U="retry",z="yes",W="btn_",X=W+j,V=W+F,$=W+O,J=W+I,K=W+_,Q=W+q,G=W+R,Y=W+M,Z=W+D,et=W+U,tt=W+P,nt=W+H,rt=W+z,it="img",st=it+X,ot=it+V,ut=it+$,at=it+J,ft=it+K,lt=it+Q,ct=it+G,ht=it+Y,pt=it+Z,dt=it+et,vt=it+tt,mt=it+nt,gt=it+rt,yt="spin",bt=yt+K,wt=yt+Y,Et=yt+tt,St=yt+nt,xt="focusnext",Tt="validationerror",Nt="uichanged",Ct=h+B,kt=O+B,Lt=M+B,At=_+B,Ot=H+B,Mt=D+B,_t=P+B;e.mix(Dt.prototype,{cleanupWidgets:function(t){var n=this,r=e.Widget;r&&n.all(".yui3-widget").each(function(e){if(n.one("#"+e.get("id"))){var i=r.getByNode(e);i&&i.destroy(t)}})},cleanup:function(){var e=this;e.cleanupWidgets(!0),e.empty()}},!0),e.Node.ITSANodeCleanup=Dt,e.Base.mix(e.Node,[Dt]),n=e.ITSAViewModel=e.Base.create(c,e.View,[],{},{ATTRS:{editable:{value:!1,validator:function(e){return typeof e===S},getter:function(e){var t=this.get(p);return e&&t&&t.toJSONUI}},model:{value:{},validator:function(e){return e===null||r.isObject(e)||typeof e===x||e.get&&typeof e.get===T&&e.get("clientId")},setter:"_setModel"},template:{value:null,validator:function(e){return typeof e===x},getter:function(e){var t=this;return t._textTemplate||e||t._intl.undefined_template}}}}),n.prototype._formcss_loaded=!1,n.prototype.initializer=function(){var t=this,n=t.get(p);i.each([kt,Lt,Mt,_t,Ot,Ct,At,Tt,Nt],function(n){t["_defPrevFn_"+n]=function(e){e.modelEventFacade.preventDefault()},t.publish(n,{preventedFn:e.bind(t["_defPrevFn_"+n],t),emitFacade:!0})}),t.publish(xt,{defaultFn:e.bind(t[E+xt],t),emitFacade:!0}),t._isMicroTemplate=null,t._modelRenderer=null,t._eventhandlers=[],t._textTemplate=null,t._setTemplateRenderer(t.get(N)),n&&n.addTarget&&n.addTarget(t),t._intl=o.get(l+c),t._customBtns={},t._customBtnLabels={},t._createButtons()},n.prototype.addCustomBtn=function(e,t,n){var r=this;A[e]||(r._customBtns[e]={config:n,labelHTML:t||e},r._setTemplateRenderer(r.get("template")))},n.prototype.removeCustomBtn=function(e){delete this._customBtns[e]},n.prototype.removeButtonLabel=function(e){delete this._customBtnLabels[e]},n.prototype.render=function(t){var n=this,r=n.get(C),i=r.itsatabkeymanager,s=n.get(p),o=n.get(N),u=e.Global.ItsaDateTimePicker,a=t||!s?"":n._modelRenderer(s);if(o||n._isMicroTemplate)o&&(n._initialEditAttrs=s.getAttrs()),r.cleanupWidgets(!0);return n._rendered||(r.inDoc()||e.one("body").append(r),r.addClass(c),n._bindUI()),n._rendered=!0,r.setHTML(a),o&&e.use(l+"itsatabkeymanager",function(){i?i.refresh(r):(r.plug(e.Plugin.ITSATabKeyManager),i=r.itsatabkeymanager),n.get("focused")&&i.focusInitialItem()}),u&&u.panel.get("visible")&&u.hide(!0),n.fire("viewrendered",{target:n}),n},n.prototype.setButtonLabel=function(e,t){var n=this;A[e]&&typeof t===x&&t.length>0&&(n._customBtnLabels[e]=t)},n.prototype.toJSON=function(){var t=this.get(p);return t instanceof e.Model?t.toJSON():t},n.prototype.destructor=function(){var e=this,t=e.get(p),n=e.get(C);t&&t.removeTarget&&t.removeTarget(e),e._clearEventhandlers(),e._customBtns={},e._customBtnLabels={},n.hasPlugin("itsatabkeymanager")&&n.unplug("itsatabkeymanager")},n.prototype._bindUI=function(){var t=this,n=t.get(C),r=t._eventhandlers;r.push(t.after("modelChange",function(e){var n=e.prevVal,r=e.newVal,i=n&&n.toJSONUI,s=r&&r.toJSONUI;n&&n.removeTarget&&n.removeTarget(t),r&&r.addTarget&&r.addTarget(t),i!==s&&t._setTemplateRenderer(t.get("template"),s&&t.get(N)),t.render()})),r.push(t.after("templateChange",function(){t._setTemplateRenderer(t.get(N)),t.render()})),r.push(t.after("resetclick",function(){var e=n.itsatabkeymanager;t._isMicroTemplate&&t.render(),e&&e.focusInitialItem()})),r.push(t.after("editableChange",function(e){var n=e.newVal,r=t.get(p);r&&r.toJSONUI&&(t._setTemplateRenderer(n),t.render())})),r.push(t.after("*:change",function(n){n.target instanceof e.Model&&!t.get(N)&&t.render()})),r.push(t.after([p+H,p+P,p+_,p+D],function(e){var t=n.itsatabkeymanager;t&&(e.model.enableUI(),t.focusInitialItem())})),r.push(t.after("*:destroy",function(e){e.target!==t&&t.render(!0)})),r.push(e.Intl.after("intl:langChange",function(){t._intl=e.Intl.get(l+c)})),i.each([O,M,D,P,H,_,B,Tt,Nt,xt],function(e){r.push(t.on("*:"+e,function(n){var r=!0,i=e,s,o;n.target!==t&&(k[e]?i=p+e:e===B&&(o=n.type.split(":")[0],L[o]?i=o+e:r=!1),s={type:i,model:t.get(p),modelEventFacade:n,target:t,value:n.value,node:n.node,nodeid:n.nodeid,formElement:n.formElement},r&&t.fire(i,s))}))})},i.each([d,v,m,g,y],function(t){n.prototype[p+t]=function(){var n=this,r=n.get(p);r instanceof e.Model&&!r.get(w)&&r[E+t]&&r[E+t]()}}),i.each([d,v,m,g],function(t){n.prototype[p+t+b]=function(){var n=this,r=n.get(p),i=t.toLowerCase();return r instanceof e.Model&&!r.get(w)&&r[i+b]||null}}),n.prototype._clearEventhandlers=function(){i.each(this._eventhandlers,function(e){e.detach()})},n.prototype._createButtons=function(){var e=this,t=e._customBtnLabels;e._buttons=[{propertykey:X,type:h,value:j,labelHTML:function(){return t[X]?r.sub(t[X],{label:e._intl
[j]}):e._intl[j]}},{propertykey:V,type:h,value:F,labelHTML:function(){return t[V]?r.sub(t[V],{label:e._intl[F]}):e._intl[F]}},{propertykey:$,type:O,value:O,labelHTML:function(){return t[$]?r.sub(t[$],{label:e._intl[O]}):e._intl[O]}},{propertykey:J,type:h,value:I,labelHTML:function(){return t[J]?r.sub(t[J],{label:e._intl[I]}):e._intl[I]}},{propertykey:K,type:_,value:_,labelHTML:function(){return t[K]?r.sub(t[K],{label:e._intl[_]}):e._intl[_]}},{propertykey:Q,type:h,value:q,labelHTML:function(){return t[Q]?r.sub(t[Q],{label:e._intl[q]}):e._intl[q]}},{propertykey:G,type:h,value:R,labelHTML:function(){return t[G]?r.sub(t[G],{label:e._intl[R]}):e._intl[R]}},{propertykey:Y,type:M,value:M,labelHTML:function(){return t[Y]?r.sub(t[Y],{label:e._intl[M]}):e._intl[M]}},{propertykey:Z,type:D,value:D,labelHTML:function(){return t[Z]?r.sub(t[Z],{label:e._intl[D]}):e._intl[D]}},{propertykey:et,type:h,value:U,labelHTML:function(){return t[et]?r.sub(t[et],{label:e._intl[U]}):e._intl[U]}},{propertykey:tt,type:P,value:P,labelHTML:function(){return t[tt]?r.sub(t[tt],{label:e._intl[P]}):e._intl[P]}},{propertykey:nt,type:H,value:H,labelHTML:function(){return t[nt]?r.sub(t[nt],{label:e._intl[H]}):e._intl[H]}},{propertykey:rt,type:h,value:z,labelHTML:function(){return t[rt]?r.sub(t[rt],{label:e._intl[z]}):e._intl[z]}},{propertykey:st,type:h,value:j,config:{classname:u},labelHTML:function(){return t[st]?r.sub(t[st],{label:e._intl[j]}):r.sub(a,{type:j})+e._intl[j]}},{propertykey:ot,type:h,value:F,config:{classname:u},labelHTML:function(){return t[ot]?r.sub(t[ot],{label:e._intl[F]}):r.sub(a,{type:F})+e._intl[F]}},{propertykey:ut,type:O,value:O,config:{classname:u},labelHTML:function(){return t[ut]?r.sub(t[ut],{label:e._intl[O]}):r.sub(a,{type:O})+e._intl[O]}},{propertykey:at,type:h,value:I,config:{classname:u},labelHTML:function(){return t[at]?r.sub(t[at],{label:e._intl[I]}):r.sub(a,{type:I})+e._intl[I]}},{propertykey:ft,type:_,value:_,config:{classname:u},labelHTML:function(){return t[ft]?r.sub(t[ft],{label:e._intl[_]}):r.sub(a,{type:_})+e._intl[_]}},{propertykey:lt,type:h,value:q,config:{classname:u},labelHTML:function(){return t[lt]?r.sub(t[lt],{label:e._intl[q]}):r.sub(a,{type:q})+e._intl[q]}},{propertykey:ct,type:h,value:R,config:{classname:u},labelHTML:function(){return t[ct]?r.sub(t[ct],{label:e._intl[R]}):r.sub(a,{type:R})+e._intl[R]}},{propertykey:ht,type:M,value:M,config:{classname:u},labelHTML:function(){return t[ht]?r.sub(t[ht],{label:e._intl[M]}):r.sub(a,{type:M})+e._intl[M]}},{propertykey:pt,type:D,value:D,config:{classname:u},labelHTML:function(){return t[pt]?r.sub(t[pt],{label:e._intl[D]}):r.sub(a,{type:D})+e._intl[D]}},{propertykey:dt,type:h,value:U,config:{classname:u},labelHTML:function(){return t[dt]?r.sub(t[dt],{label:e._intl[U]}):r.sub(a,{type:U})+e._intl[U]}},{propertykey:vt,type:P,value:P,config:{classname:u},labelHTML:function(){return t[vt]?r.sub(t[vt],{label:e._intl[P]}):r.sub(a,{type:P})+e._intl[P]}},{propertykey:mt,type:H,value:H,config:{classname:u},labelHTML:function(){return t[mt]?r.sub(t[mt],{label:e._intl[H]}):r.sub(a,{type:H})+e._intl[H]}},{propertykey:gt,type:h,value:z,config:{classname:u},labelHTML:function(){return t[gt]?r.sub(t[gt],{label:e._intl[z]}):r.sub(a,{type:z})+e._intl[z]}},{propertykey:bt,type:_,value:_,config:{spinbusy:!0,classname:u},labelHTML:function(){return t[bt]?r.sub(t[bt],{label:e._intl[_]}):r.sub(a,{type:_})+e._intl[_]}},{propertykey:wt,type:M,value:M,config:{spinbusy:!0,classname:u},labelHTML:function(){return t[wt]?r.sub(t[wt],{label:e._intl[M]}):r.sub(a,{type:M})+e._intl[M]}},{propertykey:Et,type:P,value:P,config:{spinbusy:!0,classname:u},labelHTML:function(){return t[Et]?r.sub(t[Et],{label:e._intl[P]}):r.sub(a,{type:P})+e._intl[P]}},{propertykey:St,type:H,value:H,config:{spinbusy:!0,classname:u},labelHTML:function(){return t[St]?r.sub(t[St],{label:e._intl[H]}):r.sub(a,{type:H})+e._intl[H]}}]},n.prototype[E+xt]=function(){var e=this,t=e.get(C),n=t&&t.itsatabkeymanager;n&&n.next()},n.prototype._setModel=function(t){var n=this;return typeof t===x?(n._textTemplate=t,t={}):n._textTemplate=null,!n._formcss_loaded&&t.toJSONUI&&(n._formcss_loaded=!0,e.use("gallerycss-itsa-form")),t},n.prototype._setTemplateRenderer=function(t){var n=this,o=n.get("template"),u,a,l,c;u=function(){var e=/<%(.+)%>/;return e.test(o)},c=function(t,r){var o,u,a,f;i.each(n._buttons,function(n){o=n.propertykey,u=n.type,a=n.labelHTML(),f=n.config,t[o]=e.bind(r._renderBtnFns[u],r,a,f)()}),s.each(n._customBtns,function(n,i){a=n.labelHTML,f=n.config,t[i]=e.bind(r._renderBtnFns[h],r,a,f)()})},a=n._isMicroTemplate=u(),a?(l=f.compile(o),n._modelRenderer=function(e){var r=t?e.toJSONUI():n.toJSON();return e.toJSONUI&&c(r,e),l(r)}):n._modelRenderer=function(e){var i=t?e.toJSONUI():n.toJSON();return e.toJSONUI&&c(i,e),r.sub(o,i)}}},"@VERSION@",{requires:["intl","base-build","view","template-micro","model","event-custom","pluginhost-base","gallerycss-itsa-base"],lang:["ar","de","en","es","fr","hu","it","ja","nb","nl","pt","ru","zh"],skinnable:!0});
