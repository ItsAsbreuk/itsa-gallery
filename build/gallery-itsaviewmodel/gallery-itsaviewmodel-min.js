YUI.add("gallery-itsaviewmodel",function(e,t){"use strict";function At(){}var n,r=e.Lang,i=e.Array,s=e.Intl,o='<i class="itsaicon-form-{type}"></i>',u=e.Template.Micro,a="gallery-",f="itsaviewmodel",l="button",c="model",h="Save",p="Submit",d="Load",v="Destroy",m="Reset",g="Promise",y="destroyed",b="_defFn_",w="boolean",E="string",S="function",x="editable",T="container",N={destroy:!0,remove:!0,reset:!0,save:!0,submit:!0,load:!0},C="destroy",k="remove",L="load",A="reset",O="save",M="submit",_="click",D="abort",P="cancel",H="ignore",B="no",j="ok",F="retry",I="yes",q="btn_",R=q+D,U=q+P,z=q+C,W=q+H,X=q+L,V=q+B,$=q+j,J=q+k,K=q+A,Q=q+F,G=q+O,Y=q+M,Z=q+I,et="img",tt=et+R,nt=et+U,rt=et+z,it=et+W,st=et+X,ot=et+V,ut=et+$,at=et+J,ft=et+K,lt=et+Q,ct=et+G,ht=et+Y,pt=et+Z,dt="spin",vt=dt+X,mt=dt+J,gt=dt+G,yt=dt+Y,bt="focusnext",wt="validationerror",Et="uichanged",St=l+_,xt=C+_,Tt=k+_,Nt=L+_,Ct=M+_,kt=A+_,Lt=O+_;e.mix(At.prototype,{cleanupWidgets:function(t){var n=this,r=e.Widget;r&&n.all(".yui3-widget").each(function(e){if(n.one("#"+e.get("id"))){var i=r.getByNode(e);i&&i.destroy(t)}})},cleanup:function(){var e=this;e.cleanupWidgets(!0),e.empty()}},!0),e.Node.ITSANodeCleanup=At,e.Base.mix(e.Node,[At]),n=e.ITSAViewModel=e.Base.create(f,e.View,[],{},{ATTRS:{editable:{value:!1,validator:function(e){return typeof e===w},getter:function(e){var t=this.get(c);return e&&t&&t.toJSONUI}},model:{value:{},validator:function(e){return e===null||r.isObject(e)||typeof e===E||e.get&&typeof e.get===S&&e.get("clientId")},setter:"_setModel"},template:{value:null,validator:function(e){return typeof e===E},getter:function(e){var t=this;return t._textTemplate||e||t._intl.undefined_template}}}}),n.prototype.initializer=function(){var t=this,n=t.get(c);i.each([xt,Tt,kt,Lt,Ct,St,Nt,wt,Et],function(n){t["_defPrevFn_"+n]=function(e){e.modelEventFacade.preventDefault()},t.publish(n,{preventedFn:e.bind(t["_defPrevFn_"+n],t),emitFacade:!0})}),t.publish(bt,{defaultFn:e.bind(t[b+bt],t),emitFacade:!0}),t._isMicroTemplate=null,t._modelRenderer=null,t._eventhandlers=[],t._textTemplate=null,t._setTemplateRenderer(t.get(x)),n&&n.addTarget&&n.addTarget(t),t._intl=s.get(a+f),t._customBtnLabels={},t._createButtons()},n.prototype.removeButtonLabel=function(e){delete this._customBtnLabels[e]},n.prototype.render=function(t){var n=this,r=n.get(T),i=r.itsatabkeymanager,s=n.get(c),o=n.get(x),u=e.Global.ItsaDateTimePicker,l=t||!s?"":n._modelRenderer(s);if(o||n._isMicroTemplate)o&&(n._initialEditAttrs=s.getAttrs()),r.cleanupWidgets(!0);return n._rendered||(r.inDoc()||e.one("body").append(r),r.addClass(f),n._bindUI()),n._rendered=!0,r.setHTML(l),o&&e.use(a+"itsatabkeymanager",function(){i?i.refresh(r):(r.plug(e.Plugin.ITSATabKeyManager),i=r.itsatabkeymanager),n.get("focused")&&i.focusInitialItem()}),u&&u.panel.get("visible")&&u.hide(!0),n.fire("viewrendered",{target:n}),n},n.prototype.setButtonLabel=function(e,t){var n=this;N[e]&&typeof t===E&&t.length>0&&(n._customBtnLabel[e]=t)},n.prototype.toJSON=function(){var t=this.get(c);return t instanceof e.Model?t.toJSON():t},n.prototype.destructor=function(){var e=this,t=e.get(c),n=e.get(T);t&&t.removeTarget&&t.removeTarget(e),e._clearEventhandlers(),n.hasPlugin("itsatabkeymanager")&&n.unplug("itsatabkeymanager")},n.prototype._bindUI=function(){var t=this,n=t.get(T),r=t._eventhandlers;r.push(t.after("modelChange",function(e){var n=e.prevVal,r=e.newVal,i=n&&n.toJSONUI,s=r&&r.toJSONUI;n&&n.removeTarget&&n.removeTarget(t),r&&r.addTarget&&r.addTarget(t),i!==s&&t._setTemplateRenderer(t.get("template"),s&&t.get(x)),t.render()})),r.push(t.after("templateChange",function(){t._setTemplateRenderer(t.get(x)),t.render()})),r.push(t.after("*:resetclick",function(){var e=n.itsatabkeymanager;t._isMicroTemplate&&t.render(),e&&e.focusInitialItem()})),r.push(t.after("editableChange",function(e){var n=e.newVal,r=t.get(c);r&&r.toJSONUI&&(t._setTemplateRenderer(n),t.render())})),r.push(t.after("*:change",function(n){n.target instanceof e.Model&&!t.get(x)&&t.render()})),r.push(t.after([c+M,c+O,c+L,c+A],function(e){var t=n.itsatabkeymanager;t&&(e.model.enableUI(),t.focusInitialItem())})),r.push(t.after("*:destroy",function(e){e.target!==t&&t.render(!0)})),r.push(e.Intl.after("intl:langChange",function(){t._intl=e.Intl.get(a+f)})),i.each([C,k,A,O,M,L,xt,Tt,kt,Lt,Ct,St,Nt,wt,Et,bt],function(e){r.push(t.on("*:"+e,function(n){var r;n.target!==t&&(N[e]&&(e=c+e),r={type:e,model:t.get(c),modelEventFacade:n,target:t,value:n.value,node:n.node,nodeid:n.nodeid,formElement:n.formElement},t.fire(e,r))}))})},i.each([h,p,d,v,m],function(t){n.prototype[c+t]=function(){var n=this,r=n.get(c);r instanceof e.Model&&!r.get(y)&&r[b+t]&&r[b+t]()}}),i.each([h,p,d,v],function(t){n.prototype[c+t+g]=function(){var n=this,r=n.get(c),i=t.toLowerCase();return r instanceof e.Model&&!r.get(y)&&r[i+g]||null}}),n.prototype._clearEventhandlers=function(){i.each(this._eventhandlers,function(e){e.detach()})},n.prototype._createButtons=function(){var e=this,t=e._customBtnLabels;e._buttons=[{propertykey:R,type:l,value:D,labelHTML:t[D]?r.sub(t[D],{label:e._intl[D]}):e._intl[D]},{propertykey:U,type:l,value:P,labelHTML:t[P]?r.sub(t[P],{label:e._intl[P]}):e._intl[P]},{propertykey:z,type:C,value:C,labelHTML:t[C]?r.sub(t[C],{label:e._intl[C]}):e._intl[C]},{propertykey:W,type:l,value:H,labelHTML:t[H]?r.sub(t[H],{label:e._intl[H]}):e._intl[H]},{propertykey:X,type:L,value:L,labelHTML:t[L]?r.sub(t[L],{label:e._intl[L]}):e._intl[L]},{propertykey:V,type:l,value:B,labelHTML:t[B]?r.sub(t[B],{label:e._intl[B]}):e._intl[B]},{propertykey:$,type:l,value:j,labelHTML:t[j]?r.sub(t[j],{label:e._intl[j]}):e._intl[j]},{propertykey:J,type:k,value:k,labelHTML:t[k]?r.sub(t[k],{label:e._intl[k]}):e._intl[k]},{propertykey:K,type:A,value:A,labelHTML:t[A]?r.sub(t[A],{label:e._intl[A]}):e._intl[A]},{propertykey:Q,type:l,value:F,labelHTML:t[F]?r.sub(t[F],{label:e._intl[F]}):e._intl[F]},{propertykey:G,type:O,value:O,labelHTML:t[O]?r.sub(t[O],{label:e._intl[O]}):e._intl[O]},{propertykey:Y,type:M,value:
M,labelHTML:t[M]?r.sub(t[M],{label:e._intl[M]}):e._intl[M]},{propertykey:Z,type:l,value:I,labelHTML:t[I]?r.sub(t[I],{label:e._intl[I]}):e._intl[I]},{propertykey:tt,type:l,value:D,labelHTML:t[D]?r.sub(t[D],{label:e._intl[D]}):r.sub(o,{type:D})+e._intl[D]},{propertykey:nt,type:l,value:P,labelHTML:t[P]?r.sub(t[P],{label:e._intl[P]}):r.sub(o,{type:P})+e._intl[P]},{propertykey:rt,type:C,value:C,labelHTML:t[C]?r.sub(t[C],{label:e._intl[C]}):r.sub(o,{type:C})+e._intl[C]},{propertykey:it,type:l,value:H,labelHTML:t[H]?r.sub(t[H],{label:e._intl[H]}):r.sub(o,{type:H})+e._intl[H]},{propertykey:st,type:L,value:L,labelHTML:t[L]?r.sub(t[L],{label:e._intl[L]}):r.sub(o,{type:L})+e._intl[L]},{propertykey:ot,type:l,value:B,labelHTML:t[B]?r.sub(t[B],{label:e._intl[B]}):r.sub(o,{type:B})+e._intl[B]},{propertykey:ut,type:l,value:j,labelHTML:t[j]?r.sub(t[j],{label:e._intl[j]}):r.sub(o,{type:j})+e._intl[j]},{propertykey:at,type:k,value:k,labelHTML:t[k]?r.sub(t[k],{label:e._intl[k]}):r.sub(o,{type:k})+e._intl[k]},{propertykey:ft,type:A,value:A,labelHTML:t[A]?r.sub(t[A],{label:e._intl[A]}):r.sub(o,{type:A})+e._intl[A]},{propertykey:lt,type:l,value:F,labelHTML:t[F]?r.sub(t[F],{label:e._intl[F]}):r.sub(o,{type:F})+e._intl[F]},{propertykey:ct,type:O,value:O,labelHTML:t[O]?r.sub(t[O],{label:e._intl[O]}):r.sub(o,{type:O})+e._intl[O]},{propertykey:ht,type:M,value:M,labelHTML:t[M]?r.sub(t[M],{label:e._intl[M]}):r.sub(o,{type:M})+e._intl[M]},{propertykey:pt,type:l,value:I,labelHTML:t[I]?r.sub(t[I],{label:e._intl[I]}):r.sub(o,{type:I})+e._intl[I]},{propertykey:vt,type:L,value:L,config:{spinbusy:!0},labelHTML:t[L]?r.sub(t[L],{label:e._intl[L]}):r.sub(o,{type:L})+e._intl[L]},{propertykey:mt,type:k,value:k,config:{spinbusy:!0},labelHTML:t[k]?r.sub(t[k],{label:e._intl[k]}):r.sub(o,{type:k})+e._intl[k]},{propertykey:gt,type:O,value:O,config:{spinbusy:!0},labelHTML:t[O]?r.sub(t[O],{label:e._intl[O]}):r.sub(o,{type:O})+e._intl[O]},{propertykey:yt,type:M,value:M,config:{spinbusy:!0},labelHTML:t[M]?r.sub(t[M],{label:e._intl[M]}):r.sub(o,{type:M})+e._intl[M]}]},n.prototype[b+bt]=function(){var e=this,t=e.get(T),n=t&&t.itsatabkeymanager;n&&n.next()},n.prototype._setModel=function(e){var t=this;return typeof e===E?(t._textTemplate=e,e={}):t._textTemplate=null,e},n.prototype._setTemplateRenderer=function(t){var n=this,s=n.get("template"),o,a,f,l;o=function(){var e=/<%(.+)%>/;return e.test(s)},l=function(t,r){var s,o,u,a;i.each(n._buttons,function(n){s=n.propertykey,o=n.type,u=n.labelHTML,a=n.config,t[s]=e.bind(r._renderBtnFns[o],r,u,a)()})},a=n._isMicroTemplate=o(),a?(f=u.compile(s),n._modelRenderer=function(e){var r=t?e.toJSONUI():n.toJSON();return e.toJSONUI&&l(r,e),f(r)}):n._modelRenderer=function(e){var i=t?e.toJSONUI():n.toJSON();return e.toJSONUI&&l(i,e),r.sub(s,i)}}},"@VERSION@",{requires:["intl","base-build","view","template-micro","model","event-custom","pluginhost-base","gallerycss-itsa-form"],lang:["ar","de","en","es","fr","hu","it","ja","nb","nl","pt","ru","zh"],skinnable:!0});
