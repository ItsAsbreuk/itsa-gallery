YUI.add("gallery-itsapanel",function(e,t){"use strict";var n,r=e.Array,i=e.Lang,s="gallery",o="itsa-",u=s+"css-"+o,a=4e3,f="destroyed",l="string",c="boolean",h="visible",p="closable",d="width",v="height",m="boundingBox",g="contentBox",y="paddingTop",b="paddingBottom",w="button",E="focused",S=o+E,x="hidden",T="View",N="panel",C="Change",k="floated",L="body",A="header"+T,O=L+T,M="footer",_=M+T,D="number",P="offsetHeight",H="offsetWidth",B="modal",j="px",F="title",I="Right",q=F+I,R="centered",U="drag",z=U+"able",W="resize",X="resizable",V="dd",$="-plugin",J="styled",K="itsatabkeymanager",Q=o+N,G=o+J+N,Y=o+x+N,Z=o+x+"section",et=o+"inline"+N,tt="className",nt=o+"panelheader",rt=o+"panelbody",it=o+"panelfooter",st=o+"panelinnerheader",ot=o+"panelinnerbody",ut=o+"panelinnerfooter",at=o+N+"closebtn",ft='<div class="'+nt+'"><div class="'+st+'"></div></div>',lt='<div class="'+rt+'"><div class="'+ot+'"></div></div>',ct='<div class="'+it+'"><div class="'+ut+'"></div></div>',ht="<"+w+' class="pure-'+w+" itsa"+w+"-onlyicon "+at+'" data-focusable="true"><i class="itsaicon-form-abort"></i></'+w+">",pt='<div>{title}</div><div class="itsa-rightalign">{titleRight}</div>',dt="{body}",vt='<div>{footer}</div><div class="itsa-rightalign">{footerRight}</div>',mt="click",gt=mt+"outside",yt="value",bt="focusnext",wt=w+mt,Et=w+":hide",St="escape:hide";n=e.ITSAPanel=e.Base.create("itsapanel",e.Widget,[e.WidgetPosition,e.WidgetModality,e.WidgetPositionAlign,e.WidgetPositionConstrain,e.WidgetStack],null,{ATTRS:{body:{value:null,validator:function(e){return e===null||typeof e===l}},bodyView:{value:null,validator:function(t){return t===null||typeof t===l||t instanceof e.View}},className:{value:null,validator:function(e){return e===null||typeof e===l}},dragable:{value:!1,validator:function(e){return typeof e===c}},footer:{value:null,validator:function(e){return e===null||typeof e===l}},footerRight:{value:null,validator:function(e){return e===null||typeof e===l}},footerView:{value:null,validator:function(t){return t===null||typeof t===l||t instanceof e.View}},floated:{value:!0,validator:function(e){return typeof e===c}},focusOnShow:{value:!0,validator:function(e){return typeof e===c}},headerView:{value:null,validator:function(t){return t===null||typeof t===l||t instanceof e.View}},height:{value:null,lazyAdd:!1,validator:function(e){return e===null||typeof e===D},getter:"_getHeight",setter:"_setHeight"},maxHeight:{value:null,lazyAdd:!1,validator:function(e){return e===null||typeof e===D},setter:"_setMaxHeight"},maxWidth:{value:null,lazyAdd:!1,validator:function(e){return e===null||typeof e===D},setter:"_setMaxWidth"},minHeight:{value:null,lazyAdd:!1,validator:function(e){return e===null||typeof e===D},setter:"_setMinHeight"},minWidth:{value:null,lazyAdd:!1,validator:function(e){return e===null||typeof e===D},setter:"_setMinWidth"},resizable:{value:!1,validator:function(e){return typeof e===c}},styled:{value:!0,validator:function(e){return typeof e===c}},visible:{value:!1,validator:function(e){return typeof e===c}},width:{value:null,lazyAdd:!1,validator:function(e){return e===null||typeof e===D},getter:"_getWidth",setter:"_setWidth"},title:{value:null,validator:function(e){return e===null||typeof e===l}},titleRight:{value:null,validator:function(e){return e===null||typeof e===l}},closable:{value:!0,validator:function(e){return typeof e===c}}}}),n.prototype.initializer=function(){var t=this,n=t.get(m),r=t.get(tt);e.use(u+"base",u+"form"),t.publish(Et,{defaultFn:e.bind(t.hide,t),emitFacade:!0}),t.publish(St,{defaultFn:e.bind(t.hide,t),emitFacade:!0}),t._eventhandlers=[],t._partOfMultiView=!1,n.addClass(Q),n.toggleClass(et,!t.get(k)),n.toggleClass(G,t.get(J)),n.toggleClass(S,t.get(E)),n.addClass(Y),t.publish(bt,{defaultFn:e.bind(t._defFn_focusnext,t),emitFacade:!0}),t.get(h)&&t.get(g).addClass(S),r&&n.addClass(r),t.renderPromise().then(function(){t.get(h)&&n.removeClass(Y)})},n.prototype.bindUI=function(){var t=this,n=t.get(m),r=t.get(g),s=t._eventhandlers,o=t.get(A),u=t.get(O),c=t.get(_);o instanceof e.View&&!t._partOfMultiView&&o.addTarget(t),u instanceof e.View&&u.addTarget(t),c instanceof e.View&&!t._partOfMultiView&&c.addTarget(t),t.get(z)&&t.get(k)&&e.use(V+$,function(){t.get(f)||n.plug(e.Plugin.Drag).dd.addHandle("."+nt)&&n.dd.addTarget(t)}),t.get(X)&&e.use(W+$,function(){t.get(f)||r.plug(e.Plugin.Resize,{handles:["r","b","br"]}).resize.addTarget(t)}),t._setFocusManager(),s.push(e.on("keydown",function(e){e.keyCode===27&&t.get(p)&&t.fire(St,{target:t})})),s.push(t.after(h+C,function(e){var i=e.newVal;n.toggleClass(Y,!i),r.toggleClass(S,i),i?(t.get(B)||t.get("focusOnShow"))&&t.focus():t.blur()})),s.push(t.after(k+C,function(r){n.toggleClass(et,!r.newVal),t.get(z)&&(r.newVal&&!n.dd&&e.use(V+$,function(){t.get(f)||n.plug(e.Plugin.Drag).dd.addHandle("."+nt)&&n.dd.addTarget(t)}),!r.newVal&&n.dd&&n.dd.removeTarget(t)&&n.unplug(V))})),s.push(t.after(z+C,function(r){r.newVal&&t.get(k)&&!n.dd&&e.use(V+$,function(){t.get(f)||n.plug(e.Plugin.Drag).dd.addHandle("."+nt)&&n.dd.addTarget(t)}),!r.newVal&&n.dd&&n.dd.removeTarget(t)&&n.unplug(V)})),s.push(t.after(X+C,function(n){n.newVal&&!r[W]&&e.use(W+$,function(){t.get(f)||r.plug(e.Plugin.Resize,{handles:["r","b","br"]}).resize.addTarget(t)}),!n.newVal&&r[W]&&r[W].removeTarget(t)&&r[W].unplug(W)})),s.push(t.after([U+":"+U,U+":end"],function(){var t=e.ITSAFormElement,n=t&&t.tipsyOK,r=t&&t.tipsyInvalid;n&&n.get(h)&&n._lastnode&&n._alignTooltip(n._lastnode),r&&r.get(h)&&r._lastnode&&r._alignTooltip(r._lastnode)})),s.push(t.after([W+":end",v+C,d+C,"minHeight"+C,"minWidth"+C],function(){t.get(R)&&t.centered()})),s.push(t.after([A+C,O+C,_+C],function(n){n.prevVal instanceof e.View&&n.prevVal.removeTarget(t),n.newVal instanceof e.View&&(!t._partOfMultiView||n.type===O+C)&&n.newVal.addTarget(t)})),s.push(t.after("*:viewrendered",function(n){var i=n.target,s=i===t.get(_);s&&(t._footercont.toggleClass("itsa-inlinefooter",!0),i.get("container").get("parentNode").setStyle("overflow","visible"),t
._body.setStyle("minWidth",""),t._body.setStyle("minWidth",t._footer.get("offsetWidth")+"px"),t._footercont.toggleClass("itsa-inlinefooter",!1)),e.later(250,null,function(){r.pluginReady(K,a).then(function(e){e.refresh(r),r.hasClass(S)&&t.get(h)&&!t._locked&&e.focusInitialItem()})})})),s.push(t.after([M+C,M+I+C],e.bind(t._renderFooter,t))),s.push(t.after(J+C,function(e){n.toggleClass(G,e.newVal)})),s.push(t.after(tt+C,function(e){e.prevVal&&n.removeClass(e.prevVal),e.newVal&&n.addClass(e.newVal)})),s.push(t.on([F+C,q+C,p+C],function(e){var n=e.newVal,r=e.type,s=r===F+C?n:t.get(F),o=r===q+C?n:t.get(q),u=r===p+C?n:t.get(p),a=t.get(A);(!a||typeof a===l)&&t._header.setHTML(i.sub(a||pt,{title:s||"",titleRight:o===null?u?ht:"":o}))})),s.push(t.on(B+C,function(e){!t.get(k)&&e.preventDefault()})),s.push(t.on(O+C,e.bind(t._renderBody,t))),s.push(t.on(A+C,e.bind(t._renderHeader,t))),s.push(t.on(_+C,e.bind(t._renderFooter,t))),s.push(t._header.delegate(mt,function(e){t.fire(Et,{buttonNode:e.target})},"."+at)),s.push(n.delegate(mt,function(e){var n=e.currentTarget,r;r={type:wt,target:t,value:n&&n.get(yt),buttonNode:n},t.fire(wt,r)},w)),s.push(n.on(mt,function(){t.focus()})),s.push(n.on(gt,function(){t.blur()})),s.push(t.after(E+C,function(e){var n=e.newVal&&t.get(h);t.get(g).toggleClass(S,n),n&&r.pluginReady(K,a).then(function(e){e._retreiveFocus()})})),s.push(t.after("*:viewrendered",function(){t._adjustPaddingTop(),t._adjustPaddingBottom()}))},n.prototype.renderUI=function(){var e=this,t=e.get(g);t.setHTML(ft+lt+ct),e._header=t.one("."+st),e._body=t.one("."+ot),e._footer=t.one("."+ut),e._footercont=t.one("."+it),e._renderHeader(),e._renderBody(),e._renderFooter()},n.prototype.destructor=function(){var t=this,n=t.get(m),r=t.get(g),i=t.get(A),s=t.get(O),o=t.get(_);i instanceof e.View&&i.removeTarget(t),s instanceof e.View&&s.removeTarget(t),o instanceof e.View&&o.removeTarget(t),n.hasPlugin(V)&&n.dd.removeTarget(t)&&n.unplug(V),r.hasPlugin[W]&&r[W].removeTarget(t)&&r.unplug(W),r.hasPlugin(K)&&r.unplug(K),t._clearEventhandlers()},n.prototype._adjustPaddingBottom=function(){var e=this;e.get(g).setStyle(b,e._footer.get(P)+j)},n.prototype._adjustPaddingTop=function(){var e=this;e.get(g).setStyle(y,e._header.get(P)+j)},n.prototype._clearEventhandlers=function(){r.each(this._eventhandlers,function(e){e.detach()})},n.prototype._defFn_focusnext=function(){var e=this,t=e.get(g);t.hasClass(S)&&t.pluginReady(K,a).then(function(e){e.next()},function(){})},n.prototype._getHeight=function(){return Math.round(this.get(m).get(P))},n.prototype._getWidth=function(){return Math.round(this.get(m).get(H))},n.prototype._renderHeader=function(){var t=this,n=t.get(F),r=t.get(q),s=t.get(p),o=t.get(A);!o||typeof o===l?t._header.setHTML(i.sub(o||pt,{title:n||"",titleRight:r===null?s?ht:"":r})):o instanceof e.View&&(o._set("container",t._header),o.render&&o.render()),t._adjustPaddingTop()},n.prototype._renderBody=function(){var t=this,n=t.get(L),r=t.get(O);!r||typeof r===l?t._body.setHTML(i.sub(r||dt,{body:n||""})):r instanceof e.View&&(r._set("container",t._body),r.render&&r.render())},n.prototype._renderFooter=function(){var t=this,n=t.get(M),r=t.get(M+I),s=t.get(_),o=t._footer,u=!s&&!n&&!r;u||(!s||typeof s===l?o.setHTML(i.sub(s||vt,{footer:n||"",footerRight:r||""})):s instanceof e.View&&(s._set("container",t._footer),s.render&&s.render())),t._footercont.toggleClass(Z,u),t._adjustPaddingBottom()},n.prototype._setFocusManager=function(){var t=this,n=t.get(g),r=n.itsatabkeymanager;e.use(s+"-"+K,function(){t.get(f)||(r?r.refresh(n):(n.plug(e.Plugin.ITSATabKeyManager),r=n.itsatabkeymanager),n.hasClass(S)&&r.focusInitialItem())})},n.prototype._setHeight=function(e){var t=this;t.get(g).setStyle(v,e?e+j:"")},n.prototype._setMaxHeight=function(e){this.get(g).setStyle("maxHeight",e?e+j:"")},n.prototype._setMaxWidth=function(e){this.get(g).setStyle("maxWidth",e?e+j:"")},n.prototype._setMinHeight=function(e){this.get(g).setStyle("minHeight",e?e+j:"")},n.prototype._setMinWidth=function(e){this.get(g).setStyle("minWidth",e?e+j:"")},n.prototype._setWidth=function(e){var t=this;t.get(g).setStyle(d,e?e+j:"")}},"@VERSION@",{requires:["node-pluginhost","gallery-itsapluginpromise","dd-ddm","node-event-delegate","base-build","widget-modality","widget-position","widget-position-align","widget-position-constrain","widget-stack","view","widget","gallery-itsawidgetrenderpromise"],skinnable:!0});
