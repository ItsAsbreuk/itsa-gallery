YUI.add("gallery-barrelmodellist",function(e,t){"use strict";function c(){}var n,r=e.Lang,i=e.Array,s=e.Object,o='<i class="itsaicon itsaicon-controll-spin4"></i>',u="Change",a="container",f="barrelDetails",l="barrelList";e.mix(c.prototype,{cleanupWidgets:function(t){var n=this,r=e.Widget;r&&n.all(".yui3-widget").each(function(e){if(n.one("#"+e.get("id"))){var i=r.getByNode(e);i&&i.destroy(t)}})},cleanup:function(e){var t=this;e&&t.cleanupWidgets(!0),t.get("childNodes").destroy(!0)}},!0),e.Node.ITSANodeCleanup=c,e.Base.mix(e.Node,[c]),n=e.ClicktraceBarrelModellist=e.Base.create("clicktracebarrelmodellist",e.View,[],{},{ATTRS:{barrelDetails:{value:!1,validator:function(e){return typeof e=="boolean"}},barrelList:{value:null,validator:function(e){return e===null||r.isArray(e)}}}}),n.prototype.initializer=function(){var e=this,t=e.get(l);e._eventhandlers=[],e._items=[],t&&e._addModelTargets(t)},n.prototype.render=function(){var t=this,n=t.get(a),r=t.get(l),s=t.get(f),u="",c,h,p;return t._rendered?n.cleanup(!0):(t._bindUI(),t._rendered=!0),r&&i.each(r,function(t){var n=t.device;c=t.groupname,c!==h&&(u+="<h2>"+c+"</h2>",h=c),p=e.guid(),n._barrelguids||(n._barrelguids=[]),n._barrelguids.push(p),u+='<div id="'+p+'" class="itsa-barrel-parentcontainer"></div>',n._barrels||(n._barrels=[]),n._barrels.push((new e.ITSALevelBarrel({value:n.get("value"),label:o+n.get("name"),details:n.get("details"),showDetails:s,maxValue:n.get("maxValue"),className:n.get("className"),unity:n.get("unity"),color:n.get("color"),lineColor:n.get("lineColor"),backgroundColor:n.get("backgroundColor")})).renderOnAvailable("#"+p))}),n.setHTML(u),t},n.prototype.destructor=function(){var e=this,t=e.get(a);e._clearEventhandlers(),e._removeModelTargets(),e._rendered&&t.cleanup(!0),t.empty()},n.prototype._addModelTargets=function(e){var t=this;e&&i.each(e,function(e){var n=e.device;n.addTarget(t),t._items.push(n)})},n.prototype._bindUI=function(){var t=this,n=t._eventhandlers;n.push(t.after(l+u,function(e){var n=e.prevVal,r=e.newVal;n&&t._removeModelTargets(),r&&t._addModelTargets(r),t.render()})),n.push(t.after("*:change",function(t){var n=t.target,r=t.changed;n instanceof e.Model&&i.each(n._barrels,function(e){s.each(r,function(t,n){e.set(n,t.newVal)})})})),n.push(t.after("*:destroy",function(n){var r=n.target,s,o;r instanceof e.Model&&(s=t.get(a),i.each(r._barrelguids,function(e){o=s.one("#"+e),o&&(o.cleanup(!0),o.destroy(!0))}))})),n.push(t.after(f+u,function(e){var n=e.newVal,r=t.get(l);r&&i.each(r,function(e){e.device.set("showDetails",n)})}))},n.prototype._clearEventhandlers=function(){i.each(this._eventhandlers,function(e){e.detach()})},n.prototype._removeModelTargets=function(){var e=this;i.each(e._items,function(t){t.removeTarget(e)}),e._items.length=0}},"@VERSION@",{requires:["view","widget-base","node-base","gallery-itsawidgetrenderpromise","gallery-itsalevelbarrel","gallerycss-itsa-controll"]});
