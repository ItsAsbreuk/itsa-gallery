YUI.add("gallery-barrelmodellist",function(e,t){"use strict";function f(){}var n,r=e.Array,i=e.Object,s="Change",o="container",u="reset",a="modelList";e.mix(f.prototype,{cleanupWidgets:function(t){var n=this,r=e.Widget;r&&n.all(".yui3-widget").each(function(e){if(n.one("#"+e.get("id"))){var i=r.getByNode(e);i&&i.destroy(t)}})},cleanup:function(e){var t=this;e&&t.cleanupWidgets(!0),t.get("childNodes").destroy(!0)}},!0),e.Node.ITSANodeCleanup=f,e.Base.mix(e.Node,[f]),n=e.ClicktraceBarrelModellist=e.Base.create("clicktracebarrelmodellist",e.View,[],{},{ATTRS:{modelList:{value:null,validator:function(t){return t===null||t instanceof e.ModelList}}}}),n.prototype.initializer=function(){var e=this,t=e.get(a);t&&t.addTarget(e),e._eventhandlers=[],e.barrelsGroupNames=[]},n.prototype.render=function(){var t=this,n=t.get(o),r=t.get(a),i="",s,u,f;return t._rendered?n.cleanup(!0):(t._bindUI(),t._rendered=!0),console.log("size: "+r.size()),r.each(function(n,r){console.log("rendering item "+r),s=t.barrelsGroupNames[r],s!==u&&(i+="<h2>"+s+"</h2>",u=s),f=e.guid(),n._barrelguids||(n._barrelguids=[]),n._barrelguids.push(f),i+='<div id="'+f+'" class="itsa-barrel-parentcontainer"></div>',n._barrels||(n._barrels=[]),n._barrels.push((new e.ITSALevelBarrel({value:n.get("value"),label:n.get("name"),maxValue:n.get("maxValue"),className:n.get("className"),unity:n.get("unity"),color:n.get("color"),lineColor:n.get("lineColor"),backgroundColor:n.get("backgroundColor")})).renderOnAvailable("#"+f))}),n.setHTML(i),t},n.prototype.destructor=function(){var e=this,t=e.get(a),n=e.get(o);t&&t.removeTarget&&t.removeTarget(e),e._clearEventhandlers(),e._rendered&&n.cleanup(!0),n.empty()},n.prototype._bindUI=function(){var t=this,n=t._eventhandlers;n.push(t.after(a+s,function(e){var n=e.prevVal,r=e.newVal;n&&n.removeTarget&&n.removeTarget(t),r&&r.addTarget&&r.addTarget(t),t.render()})),n.push(t.after("*:"+u,function(){t.render()})),n.push(t.after("*:change",function(t){var n=t.target,s=t.changed;n instanceof e.Model&&r.each(n._barrels,function(e){i.each(s,function(t,n){e.set(n,t.newVal)})})})),n.push(t.after("*:destroy",function(n){var i=n.target,s,u;i instanceof e.Model&&(s=t.get(o),r.each(i._barrelguids,function(e){u=s.one("#"+e),u&&(u.cleanup(!0),u.destroy(!0))}))}))},n.prototype._clearEventhandlers=function(){r.each(this._eventhandlers,function(e){e.detach()})}},"@VERSION@",{requires:["view","widget-base","node-base","model-list","gallery-itsawidgetrenderpromise","gallery-itsalevelbarrel"]});
