YUI.add("gallery-itsalogin",function(e,t){"use strict";var n=e.ITSAMessageControllerClass,r=e.ITSAMessageController,i=e.Lang,s=e.Intl,o="boolean",u="info",a="warn",f="_",l="ogin",c="l"+l,h="get",p=h+"L"+l,d="application",v="itsaicon-dialog-",m=v+u,g=v+"question",y="username",b="password",w="forgot",E="email",S=y+"or"+b,x=w+y,T=w+b,N=w+S,C="send",k=C+y,L="message",A=L+"resolve",O="stayloggedin",M="gallery-itsalogin",_,D,P;r._intl=s.get(M),P=function(t,n){var i=r._intl,s="<form>"+(n.messageForgotUsernameOrPassword||i[w+"what"])+'<div class="itsa-dialog-forgotbutton itsadialog-firstbutton">{btn_'+x+"}</div>"+'<div class="itsa-dialog-forgotbutton">{btn_'+T+"}</div>"+"</form>",o=new e.ITSAMessage;return o.icon=n.iconquestion||g,o.title=n.titleForgotUsernameOrPassword||i[N],o.level=a,o.target="itsadialog",o.source=n.source||d,o.messageType=N,o.message=s,o.closeButton=!0,o.customBtns=[{buttonId:"btn_"+x,labelHTML:i[x],config:{value:x}},{buttonId:"btn_"+T,labelHTML:i[T],config:{value:T}}],r.queueMessage(o)},_=function(t,n){var i,s,u,f,l,c;return c=r._intl,i=n.formconfigForgotUsername||{},i.label||i.placeholder||(i.label=c[E]),i.fullselect=!0,i.primarybtnonenter=!1,i.classname="itsa-login"+(i.classname?" "+i.classname:""),i.required=!0,s=e.Base.create("itsamessageforgotun",e.ITSAMessage,[],null,{ATTRS:{emailaddress:{formtype:"email",formconfig:i,validator:n.validatorForgotUsername,validationerror:n.validationerrorForgotUsername}}}),u=(n.messageForgotUsername||c.entersignupaddress)+'<fieldset class="'+"itsa-login"+'">'+'<div class="pure-control-group">{emailaddress}</div>'+"</fieldset>",f=new s,l=typeof n.imageButtons===o&&n.imageButtons,f.icon=n.iconquestion||g,f.title=n.titleForgotUsername||c[x],f.message=u,f.level=a,f.target="itsadialog",f.source=n.source||d,f.messageType=N,f.closeButton=!0,l?(f.footer="{imgbtn_"+k+"}",f.customBtns=[{buttonId:"imgbtn_"+k,labelHTML:'<i class="itsaicon-dialog-question"></i>'+c[k],config:{value:k,classname:"itsabutton-iconleft"}}]):(f.footer="{imgbtn_"+k+"}",f.customBtns=[{buttonId:"btn_"+k,labelHTML:c[k],config:{value:k}}]),r.queueMessage(f)},D=function(t,n){return new e.Promise(function(e,t){e()})},n.prototype.translate=function(e){return this._intl[e]||e},n.translatePromise=function(t){return e.usePromise("intl").then(function(){var e=s.get(M);return e[t]||t},function(){return t})},n.prototype.translatePromise=n.translatePromise,n.prototype[f+p]=function(t,n,r,i){var s=this,a=s._intl,f=s._retrieveLoginParams(t,n,r,i),l,h,v,g,E,N,C,k,L,M,H;return t=f.title,n=f.message,r=f.config,E=f.syncPromise,L="btn_submit",C=typeof r.imageButtons===o&&r.imageButtons,N=r.regain,M=typeof r.forgotButton===o&&r.forgotButton||N,k=(M?"{btn_forgot}":"")+"{btn_submit}",C&&(k=k.replace(/\{btn_/g,"{imgbtn_"),L=L.replace(/btn_/g,"imgbtn_")),h=r.formconfigUsername||{},h.label||h.placeholder||(h.label=a[y]),h.fullselect=!0,h.primarybtnonenter=!1,h.classname="itsa-login"+(h.classname?" "+h.classname:""),h.required=!0,v=r.formconfigPassword||{},v.label||v.placeholder||(v.label=a[b]),v.fullselect=!0,v.primarybtnonenter=!0,v.classname="itsa-login"+(v.classname?" "+v.classname:""),v.required=!0,g=r.formconfigRemember||{},h.label&&!v.label&&(v.label=" "),v.label&&!h.label&&(h.label=" "),g.label||(g.label=a[O]),g.switchlabel=!0,s.readyPromise().then(function(){var i;return l=e.Base.create("itsamessageinput",e.ITSAMessage,[],null,{ATTRS:{username:{value:h.value||"",formtype:"text",formconfig:h,validator:r.validatorUsername,validationerror:r.validationerrorUsername},password:{value:v.value||"",formtype:b,formconfig:v,validator:r.validatorPassword,validationerror:r.validationerrorPassword},remember:{value:g.value||!1,formtype:e.ITSACheckbox,formconfig:g}}}),n='<span id="itsa-messagewrapper">'+n+"</span>"+'<fieldset class="'+"itsa-login"+'">'+'<div class="pure-control-group">{'+y+"}</div>"+'<div class="pure-control-group">{'+b+"}</div>"+'<div class="itsa-login-checkbox">{remember}</div>'+"</fieldset>",i=new l,i.syncPromise=E,i.icon=r.icon||m,i.target="itsadialog",i.title=t,i.message=n,i.footer=k,i.imageButtons=C,i.closeButton=!0,i.primaryButton=r.primaryButton||L,i.timeoutReject=r.timeoutReject,i.level=u,i.source=r.source||d,i.messageType=p,i.buttonLabels=[{buttonType:"btn_submit",labelHTML:a[c]},{buttonType:"imgbtn_submit",labelHTML:'<i class="itsaicon-dialog-login"></i>'+a[c]}],M&&(i.customBtns=[{buttonId:"btn_forgot",labelHTML:a[w],config:{value:"forgot"}},{buttonId:"imgbtn_forgot",labelHTML:'<i class="itsaicon-dialog-question"></i>'+a[w],config:{value:"forgot",classname:"itsabutton-iconleft"}}],i.on(A,function(t){t.attrs&&t.attrs.button==="forgot"&&(t.preventDefault(),H=N===S?P(i,r):D(i,r),H.then(function(e){if(e.button===x)return _(i,r);if(e.button===T)return D(i,r)},function(e){}).then(function(){e.ITSADialog.resurrect(i)},function(t){e.ITSADialog.resurrect(i)}))})),s.queueMessage(i)})},n.prototype[f+N]=function(t,n,r,i){var s=this,a=s._intl,f=s._retrieveLoginParams(t,n,r,i),l,h,v,E,S,x,T,N,C,k,L,A,M,_;return t=f.title,n=f.message,r=f.config,x=f.syncPromise,k="btn_submit",N=typeof r.imageButtons===o&&r.imageButtons,T=r.regain,L=typeof r.forgotButton===o&&r.forgotButton||T,C=(L?"{btn_forgot}":"")+"{btn_submit}",N&&(C=C.replace(/\{btn_/g,"{imgbtn_"),k=k.replace(/btn_/g,"imgbtn_")),v=r.formconfigUsername||{},v.label||v.placeholder||(v.label=a[y]),v.fullselect=!0,v.primarybtnonenter=!1,v.classname="itsa-login"+(v.classname?" "+v.classname:""),v.required=!0,E=r.formconfigPassword||{},E.label||E.placeholder||(E.label=a[b]),E.fullselect=!0,E.primarybtnonenter=!0,E.classname="itsa-login"+(E.classname?" "+E.classname:""),E.required=!0,S=r.formconfigRemember||{},v.label&&!E.label&&(E.label=" "),E.label&&!v.label&&(v.label=" "),S.label||(S.label=a[O]),S.switchlabel=!0,s.readyPromise().then(function(){var i,o;return l=e.Base.create("itsamessageinput",e.ITSAMessage,[],null,{ATTRS:{username:{value:v.value||"",formtype:"text",formconfig:v,validator:r.validatorUsername,validationerror:r.validationerrorUsername
},password:{value:E.value||"",formtype:b,formconfig:E,validator:r.validatorPassword,validationerror:r.validationerrorPassword},remember:{value:S.value||!1,formtype:e.ITSACheckbox,formconfig:S}}}),n='<span id="itsa-messagewrapper">'+n+"</span>"+'<fieldset class="'+"itsa-login"+'">'+'<div class="pure-control-group">{'+y+"}</div>"+'<div class="pure-control-group">{'+b+"}</div>"+'<div class="itsa-login-checkbox">{remember}</div>'+"</fieldset>",i=new l,i.syncPromise=x,i.icon=r.icon||m,i.target="itsadialog",i.title=t,i.message=n,i.footer=C,i.imageButtons=N,i.closeButton=!0,i.primaryButton=r.primaryButton||k,i.timeoutReject=r.timeoutReject,i.level=r.level||u,i.source=r.source||d,i.messageType=p,i.buttonLabels=[{buttonType:"btn_submit",labelHTML:a[c]},{buttonType:"imgbtn_submit",labelHTML:'<i class="itsaicon-dialog-login"></i>'+a[c]}],L&&(A=r.formconfigForgotEmail||{},i.customBtns=[{buttonId:"btn_forgot",labelHTML:a[w],config:{value:"forgot"}},{buttonId:"imgbtn_forgot",labelHTML:'<i class="itsaicon-dialog-question"></i>'+a[w],config:{value:"forgot",classname:"itsabutton-iconleft"}}],M=T===y+"or"+b,_=T===b,M&&(h=e.Base.create("itsamessageforgot",e.ITSAMessage,[],null,{ATTRS:{emailaddress:{formtype:"email",formconfig:e.merge(A,{required:!0})},username:{formtype:"text",formconfig:e.merge(v,{required:!0}),validator:r.validatorUsername,validationerror:r.validationerrorUsername}}}),n="<form>"+(r.forgotMessage||a[w+"what"])+'<div class="itsa-dialog-forgotbutton itsadialog-firstbutton">{btn_'+w+y+"}</div>"+'<div class="itsa-dialog-forgotbutton">{btn_'+w+b+"}</div>"+"</form>",o=new h,o.icon=r.iconquestion||g,o.title=r.titleForgotUsernameOrPassword||a[w+y+"or"+b],o.message=n,o.closeButton=!0,o.customBtns=[{buttonId:"btn_"+w+y,labelHTML:a[w+y],config:{value:w+y}},{buttonId:"btn_"+w+b,labelHTML:a[w+b],config:{value:w+b}}]),i.forgotMessage=o),s.queueMessage(i)})},n.prototype._retrieveLoginParams=function(t,n,r,s){var o=typeof n=="string",u,a;return o||(s=r,r=n,n=t,t=null),u=typeof n=="string",u||(s=r,r=n,n="",t=null),a=i.isObject(r),a||(s=r,r={},n="",t=null),typeof s=="function"||(s=function(){return new e.Promise(function(e,t){t(new Error("no syncPromise defined"))})}),{title:t,message:n,config:r,syncPromise:s}},e[c]=e.bind(r[f+p],r)},"@VERSION@",{requires:["yui-base","intl","gallery-itsamessagecontroller","gallery-itsacheckbox","gallery-itsadialog","gallery-itsamessage","gallery-itsaviewmodelpanel","gallerycss-itsa-base","gallerycss-itsa-animatespin","gallerycss-itsa-dialog"],lang:["ar","bg","bs","cs","da","de","en","es","fa","fi","fr","he","hi","hr","hu","it","ja","nb","nl","pl","pt","ru","sk","sr","sv","uk","zh"],skinnable:!0});
