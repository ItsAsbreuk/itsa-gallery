YUI.add("gallery-itsaformelement",function(e,t){"use strict";var n,r,i,s=e.Array,o="disabled",u="itsa-widget-parent",a="pure",f="button",l=a+"-"+f,c="date",h="time",p=c+h,d=l+"-"+p,v=l+"-"+o,m=l+"-primary",g="modelattribute",y="error",b="boolean",w="picker",E="click",S="itsa-icon",x=S+c,T=S+h,N=S+p,C=' data-formelement="true"',k='<span class="format',L="</span>",A="^[\\w!#$%&'*+/=?`{|}~^-]+(?:\\.[\\w!#$%&'*+/=?`{|}~^-]+)*@(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}$",O="[a-zA-Z0-9-]+(\\.[a-zA-Z0-9-]+)+(/[\\w-]+)*",M="^(http://)?"+O,_="^(https://)?"+O,D="^(https?://)?"+O,P="^(([-]?[1-9][0-9]*)|0)$",H="^[-]?(([1-9][0-9]*)|0)(\\.[0-9]+)?$",B='<label for="',j="</label>",F="text",I="password",q="email",R="url",U="radio",z="checkbox",W="hidden",X="textarea",V="div",$="label",J="span",K="plain",Q="cursorend",G="initialfocus",Y="fullselect",Z="number",et=a+"-"+U,tt=a+"-"+z,nt="readonly",rt="checked",it="required",st="name",ot="value",ut="placeholder",at="pattern",ft="data",lt="class",ct="buttonText",ht="switch",pt=ht+"ed",dt=ht+$,vt=ht+ot,mt=p+lt,gt=$+ft,yt=ot+pt,bt=ot+"non"+pt,wt="focusable",Et="{"+o+"}",St="{"+nt+"}",xt="{"+rt+"}",Tt="{"+it+"}",Nt="{"+st+"}",Ct="{"+ot+"}",kt="{"+ut+"}",Lt="{"+at+"}",At="{"+ft+"}",Ot="{"+lt+"}",Mt="{"+W+"}",_t='id="{id}"',Dt='<label for="{id}"',Pt="{"+yt+"}",Ht="{"+bt+"}",Bt="{"+gt+"}",jt="{"+mt+"}",Ft="{"+ct+"}",It="{"+wt+"}",qt="type",Rt="submit",Ut="reset",zt="<input "+qt+'="',Wt="<"+f+" "+qt+'="',Xt=lt+st,Vt=$+"Class"+st,$t="widget",Jt=' data-labeldatetime="true"',Kt=ft+"-"+p+"=",Qt="<"+J+" "+_t+">UNDEFINED ELEMENTTYPE</"+J+">",Gt="<"+J+" "+_t+Nt+At+Mt+Ot+">"+Ct+"</"+J+">",Yt=zt+F+'" '+_t+Nt+Ct+kt+Et+Tt+St+Lt+At+It+Mt+Ot+" />",Zt=zt+I+'" '+_t+Nt+Ct+kt+Et+Tt+St+Lt+At+It+Mt+Ot+" />",en=zt+q+'" '+_t+Nt+Ct+kt+Et+Tt+St+At+It+Mt+Ot+Lt+" />",tn=zt+R+'" '+_t+Nt+Ct+kt+Et+Tt+St+At+It+Mt+Ot+Lt+" />",nn=zt+F+'" '+_t+Nt+Ct+kt+Et+Tt+St+At+It+Mt+Ot+Lt+" />",rn=zt+U+'" '+_t+Nt+Ct+Et+xt+At+It+Mt+Ot+" />",sn=zt+z+'" '+_t+Nt+Ct+Et+St+xt+At+It+Mt+Ot+" />",on=zt+W+'" '+_t+Nt+Ct+" />",un="<"+X+" "+_t+Nt+kt+Et+Tt+St+At+It+Mt+Ot+">"+Ct+"</"+X+">",an=Ht+"<"+V+" "+_t+At+It+Ot+"></"+V+">"+Pt,fn=Wt+f+'" '+_t+Nt+Ct+At+It+Mt+Ot+">"+Ft+"</"+f+">",ln=Dt+Tt+Jt+Ot+">"+Ht+Wt+f+'" '+_t+Nt+Ct+St+" "+Kt+'"'+c+'"'+At+It+" "+lt+'="'+jt+'"><i '+lt+'="'+x+'"></i></'+f+">"+Pt+"</"+$+">",cn=Dt+Tt+Jt+Ot+">"+Ht+Wt+f+'" '+_t+Nt+Ct+St+" "+Kt+'"'+h+'"'+At+It+" "+lt+'="'+jt+'"><i '+lt+'="'+T+'"></i></'+f+">"+Pt+"</"+$+">",hn=Dt+Tt+Jt+Ot+">"+Ht+Wt+f+'" '+_t+Nt+Ct+St+" "+Kt+'"'+p+'"'+At+It+" "+lt+'="'+jt+'"><i '+lt+'="'+N+'"></i></'+f+">"+Pt+"</"+$+">",pn={widget:an,plain:Gt,text:Yt,password:Zt,email:en,url:tn,number:nn,radio:rn,checkbox:sn,hidden:on,textarea:un,button:fn,reset:fn,submit:fn,date:ln,time:cn,datetime:hn},dn=function(t,n,r,i,s){return i||(t==="date"?i="%x":t==="time"?i="%X":i="%x %X"),e.use("gallery-itsadatetimepicker"),k+"value formattime-"+n+'" data-for="'+s+'">'+e.Date.format(r,{format:i})+L},vn=/\{\s*([^|}]+?)\s*(?:\|([^}]*))?\s*\}/g,mn=function(t,n){return t.replace?t.replace(vn,function(t,r){return e.Lang.isUndefined(n[r])?"":n[r]}):t};n=e.ITSAFormElement={},n.getElement=function(t,r,i){var s,o,u,a;i=i||e.guid(),r=r||{},o=typeof t=="function"&&t.NAME,typeof t=="string"&&(t=t.toLowerCase()),s={type:t,nodeid:i,config:r,name:r.name,html:n._renderedElement(o?t.NAME:t,r,i,o)};if(o){u=t;try{a=s.widget=new u(r.widgetconfig),t.NAME==="editorBase"?e.use("gallery-itsaeditorrenderpromise",function(){a.renderOnAvailable("#"+i)}):e.use("gallery-itsawidgetrenderpromise",function(){a.renderOnAvailable("#"+i)})}catch(f){e.fire(y,f)}}return s},n._renderedElement=function(t,n,r,i){var s=e.merge(n),a=typeof s[dt]===b?s[dt]:!1,y=typeof s[wt]===b?s[wt]:!0,w=n.tooltip,E=n.tooltipinvalid,S=n.nossl,x=n.onlyssl,T=n.digits,N=n[ot],O=n[g],V=n[vt],J=n[ft],rt=C,ht,pt,Et,St,xt,Tt,Nt,Ct,kt,Lt,At;J&&(rt+=" "+J),O&&(rt+=" data-"+g+'="true"'),s[ft]=rt,w&&(w=w.replace(/"/g,"''"),s[ft]+=' data-content="'+w+'" data-contentvalid="'+w+'"'),E&&typeof E=="string"&&E.length>0&&(s[ft]+=' data-contentinvalid="'+E.replace(/"/g,"''")+'"'),n[G]&&(s[ft]+=" data-"+G+'="true"');if(i)s[ft]+=' data-type="'+t+'"',s[lt]=' class="'+(n[Xt]||"")+" "+u+'"',n[$]&&(s[gt]=s[gt]||"",s[gt]+=' data-widgetlabel="true"'),s[wt]=y?" "+wt+'="'+wt+'"':"",t==="slider"&&(s[V?yt:bt]=k+"value formatslider-"+n.name+'" data-for="'+r+'">'+N+L),t=$t;else{Nt=typeof s[o]===b?s[o]:!1,Ct=typeof s[it]===b?s[it]:t===I,Lt=typeof s[nt]===b?s[nt]:!1,Tt=typeof n[W]===b?n[W]:!1,s[wt]=y?" "+wt+'="'+wt+'"':"",s[W]=Tt?" "+W+'="'+W+'"':"",s[o]=Nt?" "+o+'="'+o+'"':"",s[it]=Ct?" "+it+'="'+it+'"':"",s[nt]=Lt?" "+nt+'="'+nt+'"':"",n[ut]&&(s[ut]=" "+ut+'="'+s[ut]+'"'),n[at]&&(s[at]=" "+at+'="'+s[at]+'"'),n[st]&&(s[st]=" "+st+'="'+s[st]+'"'),t!==X&&t!==K&&N&&(s[ot]=" "+ot+'="'+s[ot]+'"');if(t===q)s[at]=" "+at+'="'+A+'"';else if(t===R)typeof S===b&&S?s[at]=" "+at+'="'+M+'"':typeof x===b&&x?s[at]=" "+at+'="'+_+'"':s[at]=" "+at+'="'+D+'"';else if(t===Z)s[at]=" "+at+'="'+(typeof T===b&&T?H:P)+'"';else if(t===U)xt=et;else if(t===z)xt=tt;else if(t===f||t===Rt||t===Ut)delete s[$],kt=!0,s[ft]+=" data-"+f+qt+'="'+t+'"',Et=n.primary,pt=Nt,n[ct]||(s[ct]=N||t),s[ot]||(s[ot]=" "+ot+'="'+s[ct]+'"');else if(t===c||t===h||t===p)N&&(s[ot]=' value="'+N.getTime()+'"'),s[ft]+=" data-"+p+'picker="true"',s[mt]=l+" "+d+(Nt?" "+v:"")+(n.primary?" "+m:""),s[V?yt:bt]=dn(t,n.name||"",N,s.format,r);n.removepattern&&s[at]&&(s[ft]+=" data-"+at+"="+s[at].substr(9),delete s[at]);if(t===F||t===Z||t===I||t===X||t===q||t===R)n[Y]&&(s[ft]+=" data-"+Y+'="true"'),n[Q]&&(s[ft]+=" data-"+Q+'="true"');(n[Xt]||kt)&&(s[lt]=' class="'+(n[Xt]||"")+(kt?" "+l:"")+(pt?" "+v:"")+(Et?" "+m:"")+'"')}return St=pn[t]||Qt,s[$]&&(xt?(s[$]='<span class="formatlabel">'+s[$]+L,ht=' class="'+xt+(n[Vt]?" "+n[Vt]:"")+'"',St=B+'{id}"'+Bt+ht+">"+(a?St+"{label}":"{label}"+St)+j):(ht=n[Vt]?' class="'+n[Vt]+'"':"",At=B+'{id}"'+Bt+ht+">{label}"+j,a?St+=At:St=At+St)),s.id=r,mn(St,s)},n.tooltipReadyPromise=function(){return n._tooltipreadypromise||(n._tooltipreadypromise=new 
e.Promise(function(t,n){r=(new e.Tipsy({placement:"right",selector:'[data-formelement][data-content]:not([data-valid="false"])',showOn:["touchstart","focus"],hideOn:["touchend","blur","keypress"]})).render(),i=(new e.Tipsy({placement:"right",selector:'[data-formelement][data-content][data-valid="false"]',showOn:["touchstart","focus"],hideOn:["touchend","blur","keypress"]})).render(),r.get("boundingBox").addClass("tipsy-formelement"),i.get("boundingBox").addClass("tipsy-formelement-invalid"),e.batch(r.renderPromise(),i.renderPromise()).then(t,n)})),n._tooltipreadypromise},e.later(500,null,n.tooltipReadyPromise),s.each([c,h,p],function(t){e.Event.define(t+w+E,{on:function(e,n,r){n._handle=e.on(E,function(e){var n=e.target;n.getAttribute(ft+"-"+p)===t&&r.fire(e)})},detach:function(e,t){t._handle.detach()},delegate:function(e,n,r,i){n._delegatehandle=e.on(E,function(e){var n=e.target;i&&n.getAttribute(ft+"-"+p)===t&&r.fire(e)},i)},detachDelegate:function(e,t){t._delegatehandle.detach()}})}),s.each([Rt,Ut],function(t){e.Event.define(t+E,{on:function(e,n,r){n._handle=e.on(E,function(e){var n=e.target;n.getAttribute(ft+"-"+f+qt)===t&&r.fire(e)})},detach:function(e,t){t._handle.detach()},delegate:function(e,n,r,i){n._delegatehandle=e.on(E,function(e){var n=e.target;i&&n.getAttribute(ft+"-"+f+qt)===t&&r.fire(e)},i)},detachDelegate:function(e,t){t._delegatehandle.detach()}})})},"@VERSION@",{requires:["yui-base","datatype-date-format","event-synthetic","yui-later","promise","gallery-tipsy","gallery-itsawidgetrenderpromise"],skinnable:!0});
