YUI.add("gallery-itsaformelement",function(e,t){"use strict";var n,r,i,s=e.Array,o=e.Object,u=e.Lang,a=e.Intl,f=e.one("body"),l=l,c="data",h="hotkey",p=c+"-for",d=p+h,v="disabled",m="widget",g="string",y="itsa-"+m+"-parent",b="pure",w="button",E=b+"-"+w,S=E+"-active",x=" itsa"+w+"-bordered",T="date",N="time",C=T+N,k=" "+E+"-"+C+" itsa"+w+"-onlyicon",L=E+"-"+v,A=E+"-primary",O="modelattribute",M="hideatstartup",_="itsa-invisible",D="renderpromise",P="gallery",H="-itsa",B="editor",j="error",F="boolean",I="[data-formelement][data-content]",q='[data-valid="false"]',R="tipsy-formelement",U="boundingBox",z="touchstart",W="touchend",X="focus",V="blur",$="keypress",J="right",K="picker",Q="click",G="itsaicon-datetime-",Y=G+T,Z=G+N,et=G+C,tt=' data-formelement="true"',nt='<span class="format',rt="</span>",it="itsa-"+h,st='<span class="'+it+'" data-'+h+'="{'+h+'}" '+d+'="{nodeid}">$1'+rt,ot="itsabutton-asktoclick",ut="^[\\w!#$%&'*+/=?`{|}~^-]+(?:\\.[\\w!#$%&'*+/=?`{|}~^-]+)*@(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}$",at="[a-zA-Z0-9-]+(\\.[a-zA-Z0-9-]+)+(/[\\w-]+)*",ft="^(http://)?"+at,lt="^(https://)?"+at,ct="^(https?://)?"+at,ht="^(([-]?[1-9][0-9]*)|0)$",pt="^[-]?(([1-9][0-9]*)|0)(\\.[0-9]+)?$",dt='<label for="',vt="</label>",mt="text",gt="password",yt="email",bt="url",wt="radio",Et="checkbox",St="hidden",xt="textarea",Tt="div",Nt="label",Ct="span",kt="plain",Lt="initialfocus",At="fullselect",Ot="number",Mt=b+"-"+wt,_t=b+"-"+Et,Dt="readonly",Pt="checked",Ht="required",Bt="name",jt="value",Ft="placeholder",It="pattern",qt="class",Rt="labelHTML",Ut="switch",zt=Ut+"ed",Wt=Ut+Nt,Xt=Ut+jt,Vt=Nt+c,$t=jt+zt,Jt=jt+"non"+zt,Kt="focusable",Qt="spinbusy",Gt="{"+v+"}",Yt="{"+Dt+"}",Zt="{"+Pt+"}",en="{"+Ht+"}",tn="{"+Bt+"}",nn="{"+jt+"}",rn="{"+Ft+"}",sn="{"+It+"}",on="{"+c+"}",un="{"+qt+"}",an="{"+St+"}",fn='id="{id}"',ln="{"+$t+"}",cn="{"+Jt+"}",hn="{"+Vt+"}",pn="{"+Rt+"}",dn="{"+Kt+"}",vn="type",mn="submit",gn="reset",yn="<input "+vn+'="',bn="<"+w+" "+vn+'="',wn=qt+Bt,En=Nt+"Class"+Bt,Sn="{"+vn+"}",xn=' data-labeldatetime="true"',Tn=c+"-"+C+"=",Nn=c+"-"+w+vn,Cn=c+"-"+w+"sub"+vn,kn="<"+Ct+" "+fn+">UNDEFINED ELEMENTTYPE</"+Ct+">",Ln="<"+Ct+" "+fn+tn+on+an+un+">"+nn+"</"+Ct+">",An=yn+mt+'" '+fn+tn+nn+rn+Gt+en+Yt+sn+on+dn+an+un+" />",On=yn+gt+'" '+fn+tn+nn+rn+Gt+en+Yt+sn+on+dn+an+un+" />",Mn=yn+yt+'" '+fn+tn+nn+rn+Gt+en+Yt+on+dn+an+un+sn+" />",_n=yn+bt+'" '+fn+tn+nn+rn+Gt+en+Yt+on+dn+an+un+sn+" />",Dn=yn+mt+'" '+fn+tn+nn+rn+Gt+en+Yt+on+dn+an+un+sn+" />",Pn=yn+wt+'" '+fn+tn+nn+Gt+Zt+on+dn+an+un+" />",Hn=yn+Et+'" '+fn+tn+nn+Gt+Yt+Zt+on+dn+an+un+" />",Bn=yn+St+'" '+fn+tn+nn+" />",jn="<"+xt+" "+fn+tn+rn+Gt+en+Yt+on+dn+an+un+">"+nn+"</"+xt+">",Fn=cn+"<"+Tt+" "+fn+tn+an+on+dn+un+"></"+Tt+">"+ln,In=bn+Sn+'" '+fn+tn+nn+on+dn+an+un+">"+pn+"</"+w+">",qn=cn+bn+w+'" '+fn+tn+nn+an+en+xn+Yt+" "+Tn+'"'+T+'"'+on+dn+un+"><i "+qt+'="'+Y+'"></i></'+w+">"+ln,Rn=cn+bn+w+'" '+fn+tn+nn+an+en+xn+Yt+" "+Tn+'"'+N+'"'+on+dn+un+"><i "+qt+'="'+Z+'"></i></'+w+">"+ln,Un=cn+bn+w+'" '+fn+tn+nn+an+en+xn+Yt+" "+Tn+'"'+C+'"'+on+dn+un+"><i "+qt+'="'+et+'"></i></'+w+">"+ln,zn={widget:Fn,plain:Ln,text:An,password:On,email:Mn,url:_n,number:Dn,radio:Pn,checkbox:Hn,hidden:Bn,textarea:jn,button:In,reset:In,submit:In,date:qn,time:Rn,datetime:Un},Wn=function(t,n,r,i,s,o,u,a,f){var l=s?" "+s:"",c=a?" "+_:"",h=typeof n===g&&n.length>0?" formattime-"+n:"";return i||(t==="date"?i="%x":t==="time"?i="%X":i="%x %X"),e.use(P+H+"datetimepicker"),nt+"value"+h+l+c+'" '+p+'="'+f+'"'+l+o+u+">"+e.Date.format(r,{format:i})+rt},Xn={date:!0,time:!0,datetime:!0},Vn={text:!0,number:!0,password:!0,textarea:!0,email:!0,url:!0},$n={button:!0,submit:!0,reset:!0},Jn={radio:!0,checkbox:!0},Kn=/\{\s*([^|}]+?)\s*(?:\|([^}]*))?\s*\}/g,Qn=function(t,n){return t.replace?t.replace(Kn,function(t,r){return e.Lang.isUndefined(n[r])?"":n[r]}):t};e.Node.prototype.displayInDoc=function(){var e=this,t=e.inDoc();while(e&&t)t=e.getStyle("display")!=="none",t&&(e=e.get("parentNode"));return t},n=e.ITSAFormElement={},n.getElement=function(t,r,i){var s,o,u,a;i=i||e.guid(),r=r||{},o=typeof t=="function"&&t.NAME,typeof t===g&&(t=t.toLowerCase()),s={type:t,nodeid:i,config:r,name:r.name,html:n._renderedElement(o?t.NAME:t,r,i,o)};if(o){u=t;try{a=s.widget=new u(r.widgetconfig),t.NAME===B+"Base"?e.use(P+H+B+D,function(){a.renderOnAvailable("#"+i)}):e.use(P+H+m+D,function(){a.renderOnAvailable("#"+i)})}catch(f){e.fire(j,f)}}return s},n._renderedElement=function(t,r,i,f){var l=e.merge(r),d=typeof l[Wt]===F?l[Wt]:!1,b=typeof l[Kt]===F?l[Kt]:!0,S=typeof l[At]===F?l[At]:!1,T=typeof l[M]===F?l[M]:!1,N=r.tooltip,D=r.tooltipinvalid,B=r.nossl,j=r.onlyssl,I=r.digits,q=r[jt],R=r[O],U=r[Xt],z=r[c],W=tt,X=Xn[t],V=r[h],$,J,K,Q,G,Y,Z,et,it,ot,at,mt,Et,Tt,Ct,Ut,zt,Gt,Yt;return z&&(W+=" "+z),R&&(W+=" data-"+O+'="true"'),l[c]=W,N&&(N=N.replace(/"/g,"''"),l[c]+=' data-content="'+N+'" data-contentvalid="'+N+'"'),D&&typeof D===g&&D.length>0&&(l[c]+=' data-contentinvalid="'+D.replace(/"/g,"''")+'"'),r[Lt]&&(l[c]+=" data-"+Lt+'="true"'),r[Bt]&&(l[Bt]=" "+Bt+'="'+l[Bt]+'"'),Y=typeof r[St]===F?r[St]:!1,Z=typeof l[v]===F?l[v]:!1,l[St]=Y?" "+St+'="'+St+'"':"",l[v]=Z?" "+v+'="'+v+'"':"",V&&(u.isObject(V)&&(Ct=a.getLang(P+"-itsaformelement")||e.config.lang,Gt=[],o.each(V,function(e,t){typeof t===g&&typeof e===g&&Gt.push(t)}),zt=0,Yt=Ct.length,s.some(Gt,function(e){var t=e.length;return(t>zt&&(zt===0||t<=Yt)||t<zt&&zt>Yt)&&Ct.match(new RegExp("^"+e))&&(Ut=e,zt=Ut.length),e===Ct}),V=V[Ut]),typeof V===g&&V.length===1&&(Tt=V.toLowerCase())),f?(l[c]+=' data-type="'+t+'"',l[qt]=' class="'+(r[wn]||"")+" "+y+(T?" "+_:"")+'"',r[Nt]&&(l[Vt]=l[Vt]||"",l[Vt]+=" data-"+m+Nt+'="true"'),l[Kt]=b?" data-"+Kt+'="true"':"",t==="slider"&&(l[U?$t:Jt]=nt+"value formatslider-"+r.name+(r[wn]?" "+r[wn]:"")+'" '+p+'="'+i+'"'+l[St]+l[v]+">"+q+rt),t=m):(et=!r["remove"+Ht]&&(typeof l[Ht]===F?l[Ht]:t===gt),at=typeof l[Dt]===F?l[Dt]:!1,l[Kt]=b?" data-"+Kt+'="true"':"",l[Ht]=et?" "+Ht+'="'+Ht+'"':"",l[Dt]=at?" "+Dt+'="'+Dt+'"':"",r[Ft]&&(l[Ft]=" "+Ft+'="'+l[Ft]+'"'),r[It]&&
(l[It]=" "+It+'="'+l[It]+'"'),t!==xt&&t!==kt&&q&&(l[jt]=" "+jt+'="'+l[jt]+'"'),t===yt?l[It]=" "+It+'="'+ut+'"':t===bt?typeof B===F&&B?l[It]=" "+It+'="'+ft+'"':typeof j===F&&j?l[It]=" "+It+'="'+lt+'"':l[It]=" "+It+'="'+ct+'"':t===Ot?l[It]=" "+It+'="'+(typeof I===F&&I?pt:ht)+'"':Jn[t]?(G=t===wt?Mt:_t,it=typeof l[Pt]===F?l[Pt]:!1,l[Pt]=it?" "+Pt+'="'+Pt+'"':""):$n[t]?(delete l[Nt],ot=!0,l[vn]=t,l[c]+=" data-"+w+vn+'="'+(r[w+vn]||t)+'"',K=r.primary,J=Z,r[Qt]&&(l[c]+=" data-"+Qt+'="true"',e.use(P+"css"+H+"-animatespin")),r[Rt]||(l[Rt]=q||t),l[jt]=" "+jt+'="'+(r[jt]||e.Escape.html(l[Rt]))+'"',Tt&&(Et=new RegExp("(?![^<]*>)("+Tt+")","i"))&&Et.test(l[Rt])&&(l[Rt]=l[Rt].replace(Et,u.sub(st,{hotkey:Tt,nodeid:i})),n._HKList||n._actHKList())):X&&(e.use(P+"css"+H+"-"+C),u.isDate(q)||(q=new Date),ot=!0,J=Z,l[jt]=' value="'+q.getTime()+'"',l[c]+=" data-"+C+'picker="true"',l[U?$t:Jt]=Wn(t,r.name||"",q,l.format,r[wn],l[St],l[v],T,i)),r.removepattern&&l[It]&&(l[c]+=" data-"+It+"="+l[It].substr(9),delete l[It]),Vn[t]&&(n._TXTList||n._actTXTList()),S&&Vn[t]&&(l[c]+=" data-"+At+'="true"'),(r[wn]||ot||T||X)&&(l[qt]=' class="'+(X?"":r[wn]||"")+(ot?" "+E+x:"")+(X?k:"")+(J?" "+L:"")+(K?" "+A:"")+(T?" "+_:"")+'"')),Q=zn[t]||kn,l[Nt]&&(Tt&&(Et=new RegExp("(?![^<]*>)("+Tt+")","i"))&&Et.test(l[Nt])&&(l[Nt]=l[Nt].replace(Et,u.sub(st,{hotkey:Tt,nodeid:i})),n._HKList||n._actHKList()),G?(l[Nt]='<span class="formatlabel">'+l[Nt]+rt,$=' class="'+G+(r[En]?" "+r[En]:"")+'"',Q=dt+'{id}"'+an+hn+$+">"+(d?Q+"{label}":"{label}"+Q)+vt):($=r[En]?' class="'+r[En]+'"':"",mt=(X?"<"+Nt:dt+'{id}"')+an+hn+$+">{label}"+vt,d?Q+=mt:Q=mt+Q)),l.id=i,Qn(Q,l)},n.tooltipReadyPromise=function(){return n._tooltipreadypromise||(n._tooltipreadypromise=new e.Promise(function(t,n){e.use(P+"-tipsy",P+H+m+D,function(){r=(new e.Tipsy({placement:J,selector:I+":not("+q+")",showOn:[z,X],hideOn:[W,V,$]})).render(),i=(new e.Tipsy({placement:J,selector:I+q,showOn:[z,X],hideOn:[W,V,$]})).render(),r.get(U).addClass(),i.get(U).addClass(R+"-invalid"),e.batch(r.renderPromise(),i.renderPromise()).then(t,n)})})),n._tooltipreadypromise},n._pressedBtn=null,n._actHKList=function(){n._HKList=!0,f.on("keydown",function(t){var r=t.charCode,i,s,o,u,a;t.altKey&&(i=String.fromCharCode(r).toLowerCase(),s=e.one("."+it+"[data-"+h+'="'+i+'"]:not(['+v+"]):not(["+Dt+"])"),s&&(o=s.getAttribute(d),u=e.one("#"+o)),u&&(u.getStyle("visibility")==="hidden"||!u.displayInDoc())?(s=e.all("."+it+"[data-"+h+'="'+i+'"]:not(['+v+"]):not(["+Dt+"])"),s.some(function(t,n){return n>0&&(o=t.getAttribute(d),u=e.one("#"+o),a=u&&u.getStyle("visibility")!=="hidden"&&u.displayInDoc()&&u),a})):a=u,a&&(t.halt(),a.focus(),a.get("tagName")==="BUTTON"&&(a.addClass(S),e.fire(ot,{buttonNode:a}),n._pressedBtn=a)))}),f.on("keyup",function(){var e=n._pressedBtn;e&&(e.removeClass(S),n._pressedBtn=null)})},n._actTXTList=function(){n._TXTList=!0,f.delegate(X,function(t){var n=t.target,r=n.getAttribute(c+"-"+At)==="true",i;!r&&n.test("input")&&t.preventDefault(),i=n.getData(l),e.ITSAFormElement._activeNode=n,i?n.clearData(l):r?n.select():(n.set("selectionStart",n.get("value").length),n.set("scrollTop",999999))},function(e,t){var n=t.target;return e===n&&n.test("input[type=text],input[type=password],input[type=url],input[type=email],textarea")}),f.delegate("mousedown",function(t){var n=t.target;e.ITSAFormElement._activeNode!==n&&n.setData(l,!0)},function(e,t){var n=t.target;return e===n&&n.test("input[type=text],input[type=password],input[type=url],input[type=email],textarea")})},e.later(500,null,n.tooltipReadyPromise),s.each([T,N,C],function(t){var n={on:function(e,n,r){n._handle=e.on(Q,function(e){var n=e.target;n&&n.get("tagName")!=="BUTTON"&&(n=n.get("parentNode"),e.target=n),n&&n.getAttribute(c+"-"+C)===t&&r.fire(e)})},detach:function(e,t){t._handle.detach()}};n.delegate=n.on,n.detachDelegate=n.detach,e.Event.define(t+K+Q,n)}),s.each([mn,gn],function(t){var n={on:function(e,n,r){n._handle=e.on(Q,function(e){var n=e.target;n&&n.get("tagName")!=="BUTTON"&&(n=n.get("parentNode"),e.target=n),n&&(n.getAttribute(Nn)===t||n.getAttribute(Nn)===w&&n.getAttribute(Cn)===t)&&r.fire(e)})},detach:function(e,t){t._handle.detach()}};n.delegate=n.on,n.detachDelegate=n.detach,e.Event.define(t+":"+Q,n)})},"@VERSION@",{requires:["yui-base","node-core","node-event-delegate","datatype-date-format","event-base","event-synthetic","yui-later","promise","event-tap","event-custom","escape","intl","gallerycss-itsa-base"],skinnable:!0});
