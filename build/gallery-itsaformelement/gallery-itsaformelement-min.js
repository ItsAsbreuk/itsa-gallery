YUI.add("gallery-itsaformelement",function(e,t){"use strict";var n,r=e.Array,i=e.Object,s=e.Lang,o=e.Intl,u=e.one("body"),a=a,f="data",l="hotkey",c=f+"-for",h=c+l,p="disabled",d="widget",v="string",m="itsa-"+d+"-parent",g="pure",y="button",b=g+"-"+y,w=b+"-active",E=" itsa"+y+"-bordered",S="date",x="time",T=S+x,N=" "+b+"-"+T+" itsa"+y+"-onlyicon",C=b+"-"+p,k=b+"-primary",L="modelattribute",A="hideatstartup",O="itsa-invisible",M="renderpromise",_="gallery",D="-itsa",P="editor",H="error",B="boolean",j="[data-formelement][data-content]",F='[data-valid="false"]',I="tipsy-formelement",q="boundingBox",R="touchstart",U="touchend",z="focus",W="blur",X="keypress",V="right",$="picker",J="click",K="itsaicon-datetime-",Q=K+S,G=K+x,Y=K+T,Z=' data-formelement="true"',et='<span class="format',tt="</span>",nt="itsa-"+l,rt='<span class="'+nt+'" data-'+l+'="{'+l+'}" '+h+'="{nodeid}">$1'+tt,it="itsabutton-asktoclick",st="^[\\w!#$%&'*+/=?`{|}~^-]+(?:\\.[\\w!#$%&'*+/=?`{|}~^-]+)*@(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}$",ot="[a-zA-Z0-9-]+(\\.[a-zA-Z0-9-]+)+(/[\\w-]+)*",ut="^(http://)?"+ot,at="^(https://)?"+ot,ft="^(https?://)?"+ot,lt="^(([-]?[1-9][0-9]*)|0)$",ct="^[-]?(([1-9][0-9]*)|0)(\\.[0-9]+)?$",ht='<label for="',pt="</label>",dt="text",vt="password",mt="email",gt="url",yt="radio",bt="checkbox",wt="hidden",Et="textarea",St="div",xt="label",Tt="span",Nt="plain",Ct="initialfocus",kt="fullselect",Lt="submitonenter",At="number",Ot=g+"-"+yt,Mt=g+"-"+bt,_t="readonly",Dt="checked",Pt="required",Ht="name",Bt="value",jt="placeholder",Ft="pattern",It="class",qt="labelHTML",Rt="switch",Ut=Rt+"ed",zt=Rt+xt,Wt=Rt+Bt,Xt=xt+f,Vt=Bt+Ut,$t=Bt+"non"+Ut,Jt="focusable",Kt="spinbusy",Qt="{"+p+"}",Gt="{"+_t+"}",Yt="{"+Dt+"}",Zt="{"+Pt+"}",en="{"+Ht+"}",tn="{"+Bt+"}",nn="{"+jt+"}",rn="{"+Ft+"}",sn="{"+f+"}",on="{"+It+"}",un="{"+wt+"}",an='id="{id}"',fn="{"+Vt+"}",ln="{"+$t+"}",cn="{"+Xt+"}",hn="{"+qt+"}",pn="{"+Jt+"}",dn="type",vn="submit",mn="reset",gn="<input "+dn+'="',yn="<"+y+" "+dn+'="',bn=It+Ht,wn=xt+"Class"+Ht,En="{"+dn+"}",Sn=' data-labeldatetime="true"',xn=f+"-"+T+"=",Tn=f+"-"+y+dn,Nn=f+"-"+y+"sub"+dn,Cn="<"+Tt+" "+an+">UNDEFINED ELEMENTTYPE</"+Tt+">",kn="<"+Tt+" "+an+en+sn+un+on+">"+tn+"</"+Tt+">",Ln=gn+dt+'" '+an+en+tn+nn+Qt+Zt+Gt+rn+sn+pn+un+on+" />",An=gn+vt+'" '+an+en+tn+nn+Qt+Zt+Gt+rn+sn+pn+un+on+" />",On=gn+mt+'" '+an+en+tn+nn+Qt+Zt+Gt+sn+pn+un+on+rn+" />",Mn=gn+gt+'" '+an+en+tn+nn+Qt+Zt+Gt+sn+pn+un+on+rn+" />",_n=gn+dt+'" '+an+en+tn+nn+Qt+Zt+Gt+sn+pn+un+on+rn+" />",Dn=gn+yt+'" '+an+en+tn+Qt+Yt+sn+pn+un+on+" />",Pn=gn+bt+'" '+an+en+tn+Qt+Gt+Yt+sn+pn+un+on+" />",Hn=gn+wt+'" '+an+en+tn+" />",Bn="<"+Et+" "+an+en+nn+Qt+Zt+Gt+sn+pn+un+on+">"+tn+"</"+Et+">",jn=ln+"<"+St+" "+an+en+un+sn+pn+on+"></"+St+">"+fn,Fn=yn+En+'" '+an+en+tn+sn+pn+un+on+">"+hn+"</"+y+">",In=ln+yn+y+'" '+an+en+tn+un+Zt+Sn+Gt+" "+xn+'"'+S+'"'+sn+pn+on+"><i "+It+'="'+Q+'"></i></'+y+">"+fn,qn=ln+yn+y+'" '+an+en+tn+un+Zt+Sn+Gt+" "+xn+'"'+x+'"'+sn+pn+on+"><i "+It+'="'+G+'"></i></'+y+">"+fn,Rn=ln+yn+y+'" '+an+en+tn+un+Zt+Sn+Gt+" "+xn+'"'+T+'"'+sn+pn+on+"><i "+It+'="'+Y+'"></i></'+y+">"+fn,Un={widget:jn,plain:kn,text:Ln,password:An,email:On,url:Mn,number:_n,radio:Dn,checkbox:Pn,hidden:Hn,textarea:Bn,button:Fn,reset:Fn,submit:Fn,date:In,time:qn,datetime:Rn},zn=function(t,n,r,i,s,o,u,a,f){var l=s?" "+s:"",h=a?" "+O:"",p=typeof n===v&&n.length>0?" formattime-"+n:"";return i||(t==="date"?i="%x":t==="time"?i="%X":i="%x %X"),e.use(_+D+"datetimepicker"),et+"value"+p+l+h+'" '+c+'="'+f+'"'+l+o+u+">"+e.Date.format(r,{format:i})+tt},Wn={date:!0,time:!0,datetime:!0},Xn={text:!0,number:!0,password:!0,textarea:!0,email:!0,url:!0},Vn={button:!0,submit:!0,reset:!0},$n={radio:!0,checkbox:!0},Jn=/\{\s*([^|}]+?)\s*(?:\|([^}]*))?\s*\}/g,Kn=function(t,n){return t.replace?t.replace(Jn,function(t,r){return e.Lang.isUndefined(n[r])?"":n[r]}):t};e.Node.prototype.displayInDoc=function(){var e=this,t=e.inDoc();while(e&&t)t=e.getStyle("display")!=="none",t&&(e=e.get("parentNode"));return t},n=e.ITSAFormElement={},n.getElement=function(t,r,i){var s,o,u,a;i=i||e.guid(),r=r||{},o=typeof t=="function"&&t.NAME,typeof t===v&&(t=t.toLowerCase()),s={type:t,nodeid:i,config:r,name:r.name,html:n._renderedElement(o?t.NAME:t,r,i,o)};if(o){u=t;try{a=s.widget=new u(r.widgetconfig),t.NAME===P+"Base"?e.use(_+D+P+M,function(){a.renderOnAvailable("#"+i)}):e.use(_+D+d+M,function(){a.renderOnAvailable("#"+i)})}catch(f){e.fire(H,f)}}return s},n._renderedElement=function(t,u,a,h){var g=e.merge(u),w=typeof g[zt]===B?g[zt]:!1,S=typeof g[Jt]===B?g[Jt]:!0,x=typeof g[kt]===B?g[kt]:!1,M=typeof g[Lt]===B?g[Lt]:!1,P=typeof g[A]===B?g[A]:!1,H=u.tooltip,j=u.tooltipinvalid,F=u.nossl,I=u.onlyssl,q=u.digits,R=u[Bt],U=u[L],z=u[Wt],W=u[f],X=Z,V=Wn[t],$=u[l],J,K,Q,G,Y,nt,it,ot,dt,bt,St,Tt,Rt,Ut,Qt,Gt,Yt,Zt,en;return W&&(X+=" "+W),U&&(X+=" data-"+L+'="true"'),g[f]=X,H&&(H=H.replace(/"/g,"''"),g[f]+=' data-content="'+H+'" data-contentvalid="'+H+'"'),j&&typeof j===v&&j.length>0&&(g[f]+=' data-contentinvalid="'+j.replace(/"/g,"''")+'"'),u[Ct]&&(g[f]+=" data-"+Ct+'="true"'),u[Ht]&&(g[Ht]=" "+Ht+'="'+g[Ht]+'"'),nt=typeof u[wt]===B?u[wt]:!1,it=typeof g[p]===B?g[p]:!1,g[wt]=nt?" "+wt+'="'+wt+'"':"",g[p]=it?" "+p+'="'+p+'"':"",$&&(s.isObject($)&&(Qt=o.getLang(_+"-itsaformelement")||e.config.lang,Zt=[],i.each($,function(e,t){typeof t===v&&typeof e===v&&Zt.push(t)}),Yt=0,en=Qt.length,r.some(Zt,function(e){var t=e.length;return(t>Yt&&(Yt===0||t<=en)||t<Yt&&Yt>en)&&Qt.match(new RegExp("^"+e))&&(Gt=e,Yt=Gt.length),e===Qt}),$=$[Gt]),typeof $===v&&$.length===1&&(Ut=$.toLowerCase())),h?(g[f]+=' data-type="'+t+'"',g[It]=' class="'+(u[bn]||"")+" "+m+(P?" "+O:"")+'"',u[xt]&&(g[Xt]=g[Xt]||"",g[Xt]+=" data-"+d+xt+'="true"'),g[Jt]=S?" data-"+Jt+'="true"':"",t==="slider"&&(g[z?Vt:$t]=et+"value formatslider-"+u.name+(u[bn]?" "+u[bn]:"")+'" '+c+'="'+a+'"'+g[wt]+g[p]+">"+R+tt),t=d):(ot=!u["remove"+Pt]&&(typeof g[Pt]===B?g[Pt]:t===vt),St=typeof g[_t]===B?g[_t]:!1,g[Jt]=S?" data-"+Jt+'="true"':"",g[Pt]=ot?" "+Pt+'="'+Pt+'"':"",g[_t]=St?" "+_t+'="'+_t+'"':""
,u[jt]&&(g[jt]=" "+jt+'="'+g[jt]+'"'),u[Ft]&&(g[Ft]=" "+Ft+'="'+g[Ft]+'"'),t!==Et&&t!==Nt&&R&&(g[Bt]=" "+Bt+'="'+g[Bt]+'"'),t===mt?g[Ft]=" "+Ft+'="'+st+'"':t===gt?typeof F===B&&F?g[Ft]=" "+Ft+'="'+ut+'"':typeof I===B&&I?g[Ft]=" "+Ft+'="'+at+'"':g[Ft]=" "+Ft+'="'+ft+'"':t===At?g[Ft]=" "+Ft+'="'+(typeof q===B&&q?ct:lt)+'"':$n[t]?(Y=t===yt?Ot:Mt,dt=typeof g[Dt]===B?g[Dt]:!1,g[Dt]=dt?" "+Dt+'="'+Dt+'"':""):Vn[t]?(delete g[xt],bt=!0,g[dn]=t,g[f]+=" data-"+y+dn+'="'+(u[y+dn]||t)+'"',Q=u.primary,K=it,u[Kt]&&(g[f]+=" data-"+Kt+'="true"',e.use(_+"css"+D+"-animatespin")),u[qt]||(g[qt]=R||t),g[Bt]=" "+Bt+'="'+(u[Bt]||e.Escape.html(g[qt]))+'"',Ut&&(Rt=new RegExp("(?![^<]*>)("+Ut+")","i"))&&Rt.test(g[qt])&&(g[qt]=g[qt].replace(Rt,s.sub(rt,{hotkey:Ut,nodeid:a})),n._HKList||n._actHKList())):V&&(e.use(_+"css"+D+"-"+T),s.isDate(R)||(R=new Date),bt=!0,K=it,g[Bt]=' value="'+R.getTime()+'"',g[f]+=" data-"+T+'picker="true"',g[z?Vt:$t]=zn(t,u.name||"",R,g.format,u[bn],g[wt],g[p],P,a)),u.removepattern&&g[Ft]&&(g[f]+=" data-"+Ft+"="+g[Ft].substr(9),delete g[Ft]),Xn[t]&&(n._TXTList||n._actTXTList()),x&&Xn[t]&&(g[f]+=" data-"+kt+'="true"'),M&&Xn[t]&&(g[f]+=" data-"+Lt+'="true"'),(u[bn]||bt||P||V)&&(g[It]=' class="'+(V?"":u[bn]||"")+(bt?" "+b+E:"")+(V?N:"")+(K?" "+C:"")+(Q?" "+k:"")+(P?" "+O:"")+'"')),G=Un[t]||Cn,g[xt]&&(Ut&&(Rt=new RegExp("(?![^<]*>)("+Ut+")","i"))&&Rt.test(g[xt])&&(g[xt]=g[xt].replace(Rt,s.sub(rt,{hotkey:Ut,nodeid:a})),n._HKList||n._actHKList()),Y?(g[xt]='<span class="formatlabel">'+g[xt]+tt,J=' class="'+Y+(u[wn]?" "+u[wn]:"")+'"',G=ht+'{id}"'+un+cn+J+">"+(w?G+"{label}":"{label}"+G)+pt):(J=u[wn]?' class="'+u[wn]+'"':"",Tt=(V?"<"+xt:ht+'{id}"')+un+cn+J+">{label}"+pt,w?G+=Tt:G=Tt+G)),g.id=a,Kn(G,g)},n.tooltipReadyPromise=function(){return n._tooltipreadypromise||(n._tooltipreadypromise=new e.Promise(function(t,r){e.use(_+"-tipsy",_+D+d+M,function(){var i=n.tipsyOK=(new e.Tipsy({placement:V,selector:j+":not("+F+")",showOn:[R,z],hideOn:[U,W,X]})).render(),s=n.tipsyInvalid=(new e.Tipsy({placement:V,selector:j+F,showOn:[R,z],hideOn:[U,W,X]})).render();i.get(q).addClass(),s.get(q).addClass(I+"-invalid"),e.batch(i.renderPromise(),s.renderPromise()).then(t,r)})})),n._tooltipreadypromise},n._pressedBtn=null,n._actHKList=function(){n._HKList=!0,u.on("keydown",function(t){var r=t.charCode,i,s,o,u,a;t.altKey&&(i=String.fromCharCode(r).toLowerCase(),s=e.one("."+nt+"[data-"+l+'="'+i+'"]:not(['+p+"]):not(["+_t+"])"),s&&(o=s.getAttribute(h),u=e.one("#"+o)),u&&(u.getStyle("visibility")==="hidden"||!u.displayInDoc())?(s=e.all("."+nt+"[data-"+l+'="'+i+'"]:not(['+p+"]):not(["+_t+"])"),s.some(function(t,n){return n>0&&(o=t.getAttribute(h),u=e.one("#"+o),a=u&&u.getStyle("visibility")!=="hidden"&&u.displayInDoc()&&u),a})):a=u,a&&(t.halt(),a.focus(),a.get("tagName")==="BUTTON"&&(a.addClass(w),e.fire(it,{buttonNode:a}),n._pressedBtn=a)))}),u.on("keyup",function(){var e=n._pressedBtn;e&&(e.removeClass(w),n._pressedBtn=null)})},n._actTXTList=function(){n._TXTList=!0,u.delegate(z,function(t){var n=t.target,r=n.getAttribute(f+"-"+kt)==="true",i;!r&&n.test("input")&&t.preventDefault(),i=n.getData(a),e.ITSAFormElement._activeNode=n,i?n.clearData(a):r?n.select():(n.set("selectionStart",n.get("value").length),n.set("scrollTop",999999))},function(e,t){var n=t.target;return e===n&&n.test("input[type=text],input[type=password],input[type=url],input[type=email],textarea")}),u.delegate("mousedown",function(t){var n=t.target;e.ITSAFormElement._activeNode!==n&&n.setData(a,!0)},function(e,t){var n=t.target;return e===n&&n.test("input[type=text],input[type=password],input[type=url],input[type=email],textarea")})},e.later(500,null,n.tooltipReadyPromise),r.each([S,x,T],function(t){var n={on:function(e,n,r){n._handle=e.on(J,function(e){var n=e.target;n&&n.get("tagName")!=="BUTTON"&&(n=n.get("parentNode"),e.target=n),n&&n.getAttribute(f+"-"+T)===t&&r.fire(e)})},detach:function(e,t){t._handle.detach()}};n.delegate=n.on,n.detachDelegate=n.detach,e.Event.define(t+$+J,n)}),r.each([vn,mn],function(t){var n={on:function(e,n,r){n._handle=e.on(J,function(e){var n=e.target;n&&n.get("tagName")!=="BUTTON"&&(n=n.get("parentNode"),e.target=n),n&&(n.getAttribute(Tn)===t||n.getAttribute(Tn)===y&&n.getAttribute(Nn)===t)&&r.fire(e)})},detach:function(e,t){t._handle.detach()}};n.delegate=n.on,n.detachDelegate=n.detach,e.Event.define(t+":"+J,n)})},"@VERSION@",{requires:["yui-base","node-core","node-event-delegate","datatype-date-format","event-base","event-synthetic","yui-later","promise","event-tap","event-custom","escape","intl","gallerycss-itsa-base"],skinnable:!0});
