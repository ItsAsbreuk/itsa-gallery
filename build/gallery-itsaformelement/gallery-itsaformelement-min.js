YUI.add("gallery-itsaformelement",function(e,t){"use strict";var n,r,i,s=e.Array,o="disabled",u="itsa-widget-parent",a="pure",f="button",l=a+"-"+f,c="date",h="time",p=c+h,d=l+"-"+p,v=l+"-"+o,m=l+"-primary",g="modelattribute",y="error",b="boolean",w="min",E="max",S="picker",x="click",T="itsa-icon",N=T+c,C=T+h,k=T+p,L=' data-formelement="true"',A='<span class="format',O="</span>",M="^[\\w!#$%&'*+/=?`{|}~^-]+(?:\\.[\\w!#$%&'*+/=?`{|}~^-]+)*@(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}$",_="[a-zA-Z0-9-]+(\\.[a-zA-Z0-9-]+)+(/[\\w-]+)*",D="^(http://)?"+_,P="^(https://)?"+_,H="^(https?://)?"+_,B="^(([-]?[1-9][0-9]*)|0)$",j="^[-]?(([1-9][0-9]*)|0)(\\.[0-9]+)?$",F='<label for="',I="</label>",q="text",R="password",U="email",z="url",W="radio",X="checkbox",V="hidden",$="textarea",J="div",K="label",Q="span",G="plain",Y=a+"-"+W,Z=a+"-"+X,et="readonly",tt="checked",nt="required",rt="name",it="value",st="placeholder",ot="pattern",ut="data",at="class",ft="buttonText",lt="switch",ct=lt+"ed",ht=lt+K,pt=lt+it,dt=p+at,vt=K+ut,mt=it+ct,gt=it+"non"+ct,yt="focusable",bt="{"+o+"}",wt="{"+et+"}",Et="{"+tt+"}",St="{"+nt+"}",xt="{"+rt+"}",Tt="{"+it+"}",Nt="{"+st+"}",Ct="{"+ot+"}",kt="{"+ut+"}",Lt="{"+at+"}",At="{"+V+"}",Ot='id="{id}"',Mt='<label for="{id}"',_t="{"+mt+"}",Dt="{"+gt+"}",Pt="{"+vt+"}",Ht="{"+dt+"}",Bt="{"+ft+"}",jt="{"+yt+"}",Ft="{"+w+"}",It="{"+E+"}",qt="type",Rt="submit",Ut="reset",zt="<input "+qt+'="',Wt="<"+f+" "+qt+'="',Xt=at+rt,Vt=K+"Class"+rt,$t="widget",Jt=' data-labeldatetime="true"',Kt=ut+"-"+p+"=",Qt="<"+Q+" "+Ot+">UNDEFINED ELEMENTTYPE</"+Q+">",Gt="<"+Q+" "+Ot+xt+kt+At+Lt+">"+Tt+"</"+Q+">",Yt=zt+q+'" '+Ot+xt+Tt+Nt+bt+St+wt+Ct+kt+jt+At+Lt+" />",Zt=zt+R+'" '+Ot+xt+Tt+Nt+bt+St+wt+Ct+kt+jt+At+Lt+" />",en=zt+U+'" '+Ot+xt+Tt+Nt+bt+St+wt+kt+jt+At+Lt+Ct+" />",tn=zt+z+'" '+Ot+xt+Tt+Nt+bt+St+wt+kt+jt+At+Lt+Ct+" />",nn=zt+q+'" '+Ot+xt+Ft+It+Tt+Nt+bt+St+wt+kt+jt+At+Lt+Ct+" />",rn=zt+W+'" '+Ot+xt+Tt+bt+Et+kt+jt+At+Lt+" />",sn=zt+X+'" '+Ot+xt+Tt+bt+wt+Et+kt+jt+At+Lt+" />",on=zt+V+'" '+Ot+xt+Tt+" />",un="<"+$+" "+Ot+xt+Nt+bt+St+wt+kt+jt+At+Lt+">"+Tt+"</"+$+">",an=Dt+"<"+J+" "+Ot+kt+jt+Lt+"></"+J+">"+_t,fn=Wt+f+'" '+Ot+xt+Tt+kt+jt+At+Lt+">"+Bt+"</"+f+">",ln=Mt+St+Jt+Lt+">"+Dt+Wt+f+'" '+Ot+xt+Tt+wt+" "+Kt+'"'+c+'"'+kt+jt+" "+at+'="'+Ht+'"><i '+at+'="'+N+'"></i></'+f+">"+_t+"</"+K+">",cn=Mt+St+Jt+Lt+">"+Dt+Wt+f+'" '+Ot+xt+Tt+wt+" "+Kt+'"'+h+'"'+kt+jt+" "+at+'="'+Ht+'"><i '+at+'="'+C+'"></i></'+f+">"+_t+"</"+K+">",hn=Mt+St+Jt+Lt+">"+Dt+Wt+f+'" '+Ot+xt+Tt+wt+" "+Kt+'"'+p+'"'+kt+jt+" "+at+'="'+Ht+'"><i '+at+'="'+k+'"></i></'+f+">"+_t+"</"+K+">",pn={widget:an,plain:Gt,text:Yt,password:Zt,email:en,url:tn,number:nn,radio:rn,checkbox:sn,hidden:on,textarea:un,button:fn,reset:fn,submit:fn,date:ln,time:cn,datetime:hn},dn=function(t,n,r,i,s){return i||(t==="date"?i="%x":t==="time"?i="%X":i="%x %X"),e.use("gallery-itsadatetimepicker"),A+"value formattime-"+n+'" data-for="'+s+'">'+e.Date.format(r,{format:i})+O},vn=/\{\s*([^|}]+?)\s*(?:\|([^}]*))?\s*\}/g,mn=function(t,n){return t.replace?t.replace(vn,function(t,r){return e.Lang.isUndefined(n[r])?"":n[r]}):t};n=e.ITSAFormElement={},n.getElement=function(t,r,i){var s,o,u,a;i=i||e.guid(),r=r||{},o=typeof t=="function"&&t.NAME,typeof t=="string"&&(t=t.toLowerCase()),s={type:t,nodeid:i,config:r,name:r.name,html:n._renderedElement(o?t.NAME:t,r,i,o)};if(o){u=t;try{a=s.widget=new u(r.widgetconfig),t.NAME==="editorBase"?e.use("gallery-itsaeditorrenderpromise",function(){a.renderOnAvailable("#"+i)}):e.use("gallery-itsawidgetrenderpromise",function(){a.renderOnAvailable("#"+i)})}catch(f){e.fire(y,f)}}return s},n._renderedElement=function(t,n,r,i){var s=e.merge(n),a=typeof s[ht]===b?s[ht]:!1,y=typeof s[yt]===b?s[yt]:!0,S=n.tooltip,x=n.tooltipinvalid,T=n.nossl,N=n.onlyssl,C=n.digits,k=n.length,_=n[it],q=n[g],J=n[pt],Q=n[ut],tt=L,lt,ct,bt,wt,Et,St,xt,Tt,Nt,Ct,kt;Q&&(tt+=" "+Q),k&&(tt+=' data-length="'+k+'"'),q&&(tt+=" data-"+g+'="true"'),s[ut]=tt,S&&(S=S.replace(/"/g,"''"),s[ut]+=' data-content="'+S+'" data-contentvalid="'+S+'"'),x&&typeof x=="string"&&x.length>0&&(s[ut]+=' data-contentinvalid="'+x.replace(/"/g,"''")+'"');if(i)s[ut]+=' data-type="'+t+'"',s[at]=' class="'+(n[Xt]||"")+" "+u+'"',n[K]&&(s[vt]=s[vt]||"",s[vt]+=' data-widgetlabel="true"'),s[yt]=y?" "+yt+'="'+yt+'"':"",t==="slider"&&(s[J?mt:gt]=A+"value formatslider-"+n.name+'" data-for="'+r+'">'+_+O),t=$t;else{xt=typeof s[o]===b?s[o]:!1,Tt=typeof s[nt]===b?s[nt]:t===R,Ct=typeof s[et]===b?s[et]:!1,St=typeof n[V]===b?n[V]:!1,s[yt]=y?" "+yt+'="'+yt+'"':"",s[V]=St?" "+V+'="'+V+'"':"",s[o]=xt?" "+o+'="'+o+'"':"",s[nt]=Tt?" "+nt+'="'+nt+'"':"",s[et]=Ct?" "+et+'="'+et+'"':"",n[st]&&(s[st]=" "+st+'="'+s[st]+'"'),n[ot]&&(s[ot]=" "+ot+'="'+s[ot]+'"'),n[rt]&&(s[rt]=" "+rt+'="'+s[rt]+'"'),t!==$&&t!==G&&_&&(s[it]=" "+it+'="'+s[it]+'"');if(t===U)s[ot]=" "+ot+'="'+M+'"';else if(t===z)typeof T===b&&T?s[ot]=" "+ot+'="'+D+'"':typeof N===b&&N?s[ot]=" "+ot+'="'+P+'"':s[ot]=" "+ot+'="'+H+'"';else if(t==="number")s[ot]=" "+ot+'="'+(typeof C===b&&C?j:B)+'"',n.min&&(s[w]=" min="+n.min+'"'),n.max&&(s[E]+=" max="+n.max+'"');else if(t===W)Et=Y;else if(t===X)Et=Z;else if(t===f||t===Rt||t===Ut)delete s[K],Nt=!0,s[ut]+=" data-"+f+qt+'="'+t+'"',bt=n.primary,ct=xt,n[ft]||(s[ft]=_||t),s[it]||(s[it]=" "+it+'="'+s[ft]+'"');else if(t===c||t===h||t===p)_&&(s[it]=' value="'+_.getTime()+'"'),s[ut]+=" data-"+p+'picker="true"',s[dt]=l+" "+d+(xt?" "+v:"")+(n.primary?" "+m:""),s[J?mt:gt]=dn(t,n.name||"",_,s.format,r);n.removepattern&&s[ot]&&(s[ut]+=" data-"+ot+"="+s[ot].substr(9),delete s[ot]),(n[Xt]||Nt)&&(s[at]=' class="'+(n[Xt]||"")+(Nt?" "+l:"")+(ct?" "+v:"")+(bt?" "+m:"")+'"')}return wt=pn[t]||Qt,s[K]&&(Et?(s[K]='<span class="formatlabel">'+s[K]+O,lt=' class="'+Et+(n[Vt]?" "+n[Vt]:"")+'"',wt=F+'{id}"'+Pt+lt+">"+(a?wt+"{label}":"{label}"+wt)+I):(lt=n[Vt]?' class="'+n[Vt]+'"':"",kt=F+'{id}"'+Pt+lt+">{label}"+I,a?wt+=kt:wt=kt+wt)),s.id=r,mn(wt,s)},r=(new e.Tipsy({placement:"right",selector:'[data-formelement][data-content]:not([data-valid="false"])',showOn:["touchstart","focus"
],hideOn:["touchend","blur","keypress"]})).render(),r.get("boundingBox").addClass("tipsy-formelement"),i=(new e.Tipsy({placement:"right",selector:'[data-formelement][data-content][data-valid="false"]',showOn:["touchstart","focus"],hideOn:["touchend","blur","keypress"]})).render(),i.get("boundingBox").addClass("tipsy-formelement-invalid"),s.each([c,h,p],function(t){e.Event.define(t+S+x,{on:function(e,n,r){n._handle=e.on(x,function(e){var n=e.target;n.getAttribute(ut+"-"+p)===t&&r.fire(e)})},detach:function(e,t){t._handle.detach()},delegate:function(e,n,r,i){n._delegatehandle=e.on(x,function(e){var n=e.target;i&&n.getAttribute(ut+"-"+p)===t&&r.fire(e)},i)},detachDelegate:function(e,t){t._delegatehandle.detach()}})}),s.each([Rt,Ut],function(t){e.Event.define(t+x,{on:function(e,n,r){n._handle=e.on(x,function(e){var n=e.target;n.getAttribute(ut+"-"+f+qt)===t&&r.fire(e)})},detach:function(e,t){t._handle.detach()},delegate:function(e,n,r,i){n._delegatehandle=e.on(x,function(e){var n=e.target;i&&n.getAttribute(ut+"-"+f+qt)===t&&r.fire(e)},i)},detachDelegate:function(e,t){t._delegatehandle.detach()}})})},"@VERSION@",{requires:["yui-base","datatype-date-format","event-synthetic","gallery-tipsy"],skinnable:!0});
