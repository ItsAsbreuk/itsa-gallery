YUI.add("gallery-itsaformelement",function(e,t){"use strict";var n,r,i,s=e.Array,o=e.Lang,u=e.one("body"),a=a,f="disabled",l="itsa-widget-parent",c="pure",h="button",p=c+"-"+h,d="date",v="time",m=d+v,g=p+"-"+m,y=p+"-"+f,b=p+"-primary",w="modelattribute",E="hideatstartup",S="itsa-invisible",x="error",T="boolean",N="picker",C="click",k="itsa-icon",L=k+d,A=k+v,O=k+m,M=' data-formelement="true"',_='<span class="format',D="</span>",P="^[\\w!#$%&'*+/=?`{|}~^-]+(?:\\.[\\w!#$%&'*+/=?`{|}~^-]+)*@(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}$",H="[a-zA-Z0-9-]+(\\.[a-zA-Z0-9-]+)+(/[\\w-]+)*",B="^(http://)?"+H,j="^(https://)?"+H,F="^(https?://)?"+H,I="^(([-]?[1-9][0-9]*)|0)$",q="^[-]?(([1-9][0-9]*)|0)(\\.[0-9]+)?$",R='<label for="',U="</label>",z="text",W="password",X="email",V="url",$="radio",J="checkbox",K="hidden",Q="textarea",G="div",Y="label",Z="span",et="plain",tt="initialfocus",nt="fullselect",rt="number",it=c+"-"+$,st=c+"-"+J,ot="readonly",ut="checked",at="required",ft="name",lt="value",ct="placeholder",ht="pattern",pt="data",dt="class",vt="labelHTML",mt="switch",gt=mt+"ed",yt=mt+Y,bt=mt+lt,wt=Y+pt,Et=lt+gt,St=lt+"non"+gt,xt="focusable",Tt="{"+f+"}",Nt="{"+ot+"}",Ct="{"+ut+"}",kt="{"+at+"}",Lt="{"+ft+"}",At="{"+lt+"}",Ot="{"+ct+"}",Mt="{"+ht+"}",_t="{"+pt+"}",Dt="{"+dt+"}",Pt="{"+K+"}",Ht='id="{id}"',Bt="{"+Et+"}",jt="{"+St+"}",Ft="{"+wt+"}",It="{"+vt+"}",qt="{"+xt+"}",Rt="type",Ut="submit",zt="reset",Wt="<input "+Rt+'="',Xt="<"+h+" "+Rt+'="',Vt=dt+ft,$t=Y+"Class"+ft,Jt="widget",Kt="{"+Rt+"}",Qt=' data-labeldatetime="true"',Gt=pt+"-"+m+"=",Yt=pt+"-"+h+Rt,Zt=pt+"-"+h+"sub"+Rt,en="<"+Z+" "+Ht+">UNDEFINED ELEMENTTYPE</"+Z+">",tn="<"+Z+" "+Ht+Lt+_t+Pt+Dt+">"+At+"</"+Z+">",nn=Wt+z+'" '+Ht+Lt+At+Ot+Tt+kt+Nt+Mt+_t+qt+Pt+Dt+" />",rn=Wt+W+'" '+Ht+Lt+At+Ot+Tt+kt+Nt+Mt+_t+qt+Pt+Dt+" />",sn=Wt+X+'" '+Ht+Lt+At+Ot+Tt+kt+Nt+_t+qt+Pt+Dt+Mt+" />",on=Wt+V+'" '+Ht+Lt+At+Ot+Tt+kt+Nt+_t+qt+Pt+Dt+Mt+" />",un=Wt+z+'" '+Ht+Lt+At+Ot+Tt+kt+Nt+_t+qt+Pt+Dt+Mt+" />",an=Wt+$+'" '+Ht+Lt+At+Tt+Ct+_t+qt+Pt+Dt+" />",fn=Wt+J+'" '+Ht+Lt+At+Tt+Nt+Ct+_t+qt+Pt+Dt+" />",ln=Wt+K+'" '+Ht+Lt+At+" />",cn="<"+Q+" "+Ht+Lt+Ot+Tt+kt+Nt+_t+qt+Pt+Dt+">"+At+"</"+Q+">",hn=jt+"<"+G+" "+Ht+Lt+Pt+_t+qt+Dt+"></"+G+">"+Bt,pn=Xt+Kt+'" '+Ht+Lt+At+_t+qt+Pt+Dt+">"+It+"</"+h+">",dn=jt+Xt+h+'" '+Ht+Lt+At+Pt+kt+Qt+Nt+" "+Gt+'"'+d+'"'+_t+qt+Dt+"><i "+dt+'="'+L+'"></i></'+h+">"+Bt,vn=jt+Xt+h+'" '+Ht+Lt+At+Pt+kt+Qt+Nt+" "+Gt+'"'+v+'"'+_t+qt+Dt+"><i "+dt+'="'+A+'"></i></'+h+">"+Bt,mn=jt+Xt+h+'" '+Ht+Lt+At+Pt+kt+Qt+Nt+" "+Gt+'"'+m+'"'+_t+qt+Dt+"><i "+dt+'="'+O+'"></i></'+h+">"+Bt,gn={widget:hn,plain:tn,text:nn,password:rn,email:sn,url:on,number:un,radio:an,checkbox:fn,hidden:ln,textarea:cn,button:pn,reset:pn,submit:pn,date:dn,time:vn,datetime:mn},yn=function(t,n,r,i,s,o,u,a){var f=s?" "+s:"",l=u?" "+S:"",c=typeof n=="string"&&n.length>0?" formattime-"+n:"";return i||(t==="date"?i="%x":t==="time"?i="%X":i="%x %X"),e.use("gallery-itsadatetimepicker"),_+"value"+c+f+l+'" data-for="'+a+'"'+f+o+">"+e.Date.format(r,{format:i})+D},bn=/\{\s*([^|}]+?)\s*(?:\|([^}]*))?\s*\}/g,wn=function(t,n){return t.replace?t.replace(bn,function(t,r){return e.Lang.isUndefined(n[r])?"":n[r]}):t};n=e.ITSAFormElement={},n._dateTimeTypes={date:!0,time:!0,datetime:!0},n._fullSelectTypes={text:!0,number:!0,password:!0,textarea:!0,email:!0,url:!0},n._buttonsTypes={button:!0,submit:!0,reset:!0},n._radioCheckboxTypes={radio:!0,checkbox:!0},n.getElement=function(t,r,i){var s,o,u,a;i=i||e.guid(),r=r||{},o=typeof t=="function"&&t.NAME,typeof t=="string"&&(t=t.toLowerCase()),s={type:t,nodeid:i,config:r,name:r.name,html:n._renderedElement(o?t.NAME:t,r,i,o)};if(o){u=t;try{a=s.widget=new u(r.widgetconfig),t.NAME==="editorBase"?e.use("gallery-itsaeditorrenderpromise",function(){a.renderOnAvailable("#"+i)}):e.use("gallery-itsawidgetrenderpromise",function(){a.renderOnAvailable("#"+i)})}catch(f){e.fire(x,f)}}return s},n._renderedElement=function(t,r,i,s){var u=e.merge(r),a=typeof u[yt]===T?u[yt]:!1,c=typeof u[xt]===T?u[xt]:!0,d=typeof u[nt]===T?u[nt]:!1,v=typeof u[E]===T?u[E]:!1,x=r.tooltip,N=r.tooltipinvalid,C=r.nossl,k=r.onlyssl,L=r.digits,A=r[lt],O=r[w],H=r[bt],z=r[pt],J=M,G=n._dateTimeTypes[t],Z,mt,gt,Tt,Nt,Ct,kt,Lt,At,Ot,Mt,_t;return z&&(J+=" "+z),O&&(J+=" data-"+w+'="true"'),u[pt]=J,x&&(x=x.replace(/"/g,"''"),u[pt]+=' data-content="'+x+'" data-contentvalid="'+x+'"'),N&&typeof N=="string"&&N.length>0&&(u[pt]+=' data-contentinvalid="'+N.replace(/"/g,"''")+'"'),r[tt]&&(u[pt]+=" data-"+tt+'="true"'),r[ft]&&(u[ft]=" "+ft+'="'+u[ft]+'"'),Ct=typeof r[K]===T?r[K]:!1,u[K]=Ct?" "+K+'="'+K+'"':"",s?(u[pt]+=' data-type="'+t+'"',u[dt]=' class="'+(r[Vt]||"")+" "+l+(v?" "+S:"")+'"',r[Y]&&(u[wt]=u[wt]||"",u[wt]+=' data-widgetlabel="true"'),u[xt]=c?" data-"+xt+'="true"':"",t==="slider"&&(u[H?Et:St]=_+"value formatslider-"+r.name+(r[Vt]?" "+r[Vt]:"")+'" data-for="'+i+'"'+u[K]+">"+A+D),t=Jt):(kt=typeof u[f]===T?u[f]:!1,Lt=!r["remove"+at]&&(typeof u[at]===T?u[at]:t===W),Mt=typeof u[ot]===T?u[ot]:!1,u[xt]=c?" data-"+xt+'="true"':"",u[f]=kt?" "+f+'="'+f+'"':"",u[at]=Lt?" "+at+'="'+at+'"':"",u[ot]=Mt?" "+ot+'="'+ot+'"':"",r[ct]&&(u[ct]=" "+ct+'="'+u[ct]+'"'),r[ht]&&(u[ht]=" "+ht+'="'+u[ht]+'"'),t!==Q&&t!==et&&A&&(u[lt]=" "+lt+'="'+u[lt]+'"'),t===X?u[ht]=" "+ht+'="'+P+'"':t===V?typeof C===T&&C?u[ht]=" "+ht+'="'+B+'"':typeof k===T&&k?u[ht]=" "+ht+'="'+j+'"':u[ht]=" "+ht+'="'+F+'"':t===rt?u[ht]=" "+ht+'="'+(typeof L===T&&L?q:I)+'"':n._radioCheckboxTypes[t]?(Nt=t===$?it:st,At=typeof u[ut]===T?u[ut]:!1,u[ut]=At?" "+ut+'="'+ut+'"':"",u[f]=kt?" "+f+'="'+f+'"':""):n._buttonsTypes[t]?(delete u[Y],Ot=!0,u[Rt]=t,u[pt]+=" data-"+h+Rt+'="'+(r[h+Rt]||t)+'"',gt=r.primary,mt=kt,r[vt]||(u[vt]=A||t),u[lt]||(u[lt]=" "+lt+'="'+u[vt]+'"')):G&&(o.isDate(A)||(A=new Date),Ot=!0,mt=kt,u[lt]=' value="'+A.getTime()+'"',u[pt]+=" data-"+m+'picker="true"',u[H?Et:St]=yn(t,r.name||"",A,u.format,r[Vt],u[K],v,i)),r.removepattern&&u[ht]&&(u[pt]+=" data-"+ht+"="+u[ht].substr(9),delete u[ht]),d&&n._fullSelectTypes[t]&&(u[pt]+=" data-"+nt+'="true"'),(r[Vt]||Ot||v||G)&&(
u[dt]=' class="'+(G?"":r[Vt]||"")+(Ot?" "+p:"")+(G?" "+g:"")+(mt?" "+y:"")+(gt?" "+b:"")+(v?" "+S:"")+'"')),Tt=gn[t]||en,u[Y]&&(Nt?(u[Y]='<span class="formatlabel">'+u[Y]+D,Z=' class="'+Nt+(r[$t]?" "+r[$t]:"")+'"',Tt=R+'{id}"'+Pt+Ft+Z+">"+(a?Tt+"{label}":"{label}"+Tt)+U):(Z=r[$t]?' class="'+r[$t]+'"':"",_t=(G?"<"+Y:R+'{id}"')+Pt+Ft+Z+">{label}"+U,a?Tt+=_t:Tt=_t+Tt)),u.id=i,wn(Tt,u)},n.tooltipReadyPromise=function(){return n._tooltipreadypromise||(n._tooltipreadypromise=new e.Promise(function(t,n){r=(new e.Tipsy({placement:"right",selector:'[data-formelement][data-content]:not([data-valid="false"])',showOn:["touchstart","focus"],hideOn:["touchend","blur","keypress"]})).render(),i=(new e.Tipsy({placement:"right",selector:'[data-formelement][data-content][data-valid="false"]',showOn:["touchstart","focus"],hideOn:["touchend","blur","keypress"]})).render(),r.get("boundingBox").addClass("tipsy-formelement"),i.get("boundingBox").addClass("tipsy-formelement-invalid"),e.batch(r.renderPromise(),i.renderPromise()).then(t,n)})),n._tooltipreadypromise},e.later(500,null,n.tooltipReadyPromise),u.delegate("focus",function(t){var n=t.target,r=n.getAttribute(pt+"-"+nt)==="true",i;!r&&n.test("input")&&t.preventDefault(),i=n.getData(a),e.ITSAFormElement._activeNode=n,i?n.clearData(a):r?n.select():(n.set("selectionStart",n.get("value").length),n.set("scrollTop",999999))},function(e,t){var n=t.target;return e===n&&n.test("input[type=text],input[type=password],input[type=url],input[type=email],textarea")}),u.delegate("mousedown",function(t){var n=t.target;e.ITSAFormElement._activeNode!==n&&n.setData(a,!0)},function(e,t){var n=t.target;return e===n&&n.test("input[type=text],input[type=password],input[type=url],input[type=email],textarea")}),s.each([d,v,m],function(t){var n={on:function(e,n,r){n._handle=e.on(C,function(e){var n=e.target;n&&n.get("tagName")!=="BUTTON"&&(n=n.get("parentNode"),e.target=n),n&&n.getAttribute(pt+"-"+m)===t&&r.fire(e)})},detach:function(e,t){t._handle.detach()}};n.delegate=n.on,n.detachDelegate=n.detach,e.Event.define(t+N+C,n)}),s.each([Ut,zt],function(t){var n={on:function(e,n,r){n._handle=e.on(C,function(e){var n=e.target;n&&n.get("tagName")!=="BUTTON"&&(n=n.get("parentNode"),e.target=n),n&&(n.getAttribute(Yt)===t||n.getAttribute(Yt)===h&&n.getAttribute(Zt)===t)&&r.fire(e)})},detach:function(e,t){t._handle.detach()}};n.delegate=n.on,n.detachDelegate=n.detach,e.Event.define(t+C,n)})},"@VERSION@",{requires:["yui-base","datatype-date-format","event-synthetic","yui-later","promise","event-tap","event-custom","gallery-tipsy","gallery-itsawidgetrenderpromise"],skinnable:!0});
