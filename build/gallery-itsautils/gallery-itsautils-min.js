YUI.add("gallery-itsautils",function(e,t){"use strict";var n=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z/,r=function(e,t){return n.test(t)?new Date(t):t},i=e.Lang,s=e.Promise,o="application/json";s.cast=function(t){return e.Promise.isPromise(t)&&t.constructor===this?t:new this(function(e){e(t)})},s.prototype.cast=s.cast,s.allFulfilled=function(e){var t=this;return new t(function(n,r){function l(e,t){return function(r){a[e]=t?r:null,f[e]=t?null:r,s--,s||n({resolved:a,rejected:f})}}if(!i.isArray(e)){r(new TypeError("Promise.all expects an array of values or promises"));return}var s=e.length,o=0,u=e.length,a=[],f=[];if(u<1)return n({resolved:a,rejected:f});for(;o<u;o++)t.cast(e[o]).then(l(o,!0),l(o,!1))})},s.prototype.allFulfilled=s.allFulfilled,e.JSON.fullparse=function(e){try{return this.parse(e,r)}catch(t){throw t}},e.io.json=function(t,n){n=n||{},n.headers||(n.headers={}),n.headers.Accept=o;var i=e.io.xhr(t,n);return e.mix(i.then(function(t){return e.JSON.parse(t.responseText,r)}),{abort:i.abort},!0)},e.JSONPRequest.prototype.send=function(){function o(n,s){return typeof n=="function"?function(o){var u=!0,a="_requests",f;if(typeof o=="object"){f=e.JSON.stringify(o);try{o=e.JSON.fullparse(f)}catch(l){}}s?(++t._timeouts[i],--t._requests[i]):(t._requests[i]||(u=!1,a="_timeouts"),--t[a][i]),!t._requests[i]&&!t._timeouts[i]&&delete YUI.Env.JSONP[i],u&&n.apply(r.context,[o].concat(r.args))}:null}var t=this,n=e.Array(arguments,0,!0),r=t._config,i=t._proxy||e.guid(),s;return r.allowCache&&(t._proxy=i),t._requests[i]===undefined&&(t._requests[i]=0),t._timeouts[i]===undefined&&(t._timeouts[i]=0),t._requests[i]++,n.unshift(t.url,"YUI.Env.JSONP."+i),s=r.format.apply(t,n),r.on.success?(YUI.Env.JSONP[i]=o(r.on.success),e.Get.js(s,{onFailure:o(r.on.failure),onTimeout:o(r.on.timeout,!0),timeout:r.timeout,charset:r.charset,attributes:r.attributes,async:r.async}).execute(),t):t}},"@VERSION@",{requires:["yui-base","json","jsonp","promise","gallery-io-utils"]});
