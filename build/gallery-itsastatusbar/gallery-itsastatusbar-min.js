YUI.add("gallery-itsastatusbar",function(e,t){"use strict";function _(){_.superclass.constructor.apply(this,arguments)}var n=e.Array,r=e.Lang,i=e.Node,s="body",o="info",u="warn",a="error",f="empty",l="number",c='<div class="itsa-statusbar-container"></div>',h='<div class="itsa-statusbar-empty">ready2</div>',p='<div class="itsa-statusbar-info" style="display: none;"></div>',d='<div class="itsa-statusbar-warn" style="display: none;"></div>',v='<div class="itsa-statusbar-error" style="display: none;"></div>',m="itsa-statusbar-texttransform-",g="textTransform",y="Change",b=5e3,w="uppercase",E="lowercase",S="capitalize",x="_suspended",T="boolean",N="string",C="title",k="button",L="readyText",A='<td class="itsa-statusbar-btntd"><button class="pure-button itsabutton-rounded itsabutton-bordered">close</button></td>',O='<i class="itsa-dialogicon {icon}"></i>',M='<table><tbody><tr><td><div class="itsa-statusbar-msgtd">{icontemplate}{message}</div></td>{button}</tr></tbody></table>';_.NAME="itsastatusbar",e.ITSAStatusbar=e.extend(_,e.ITSAMessageViewer,{},{ATTRS:{fadeDelay:{value:.2,validator:function(e){return typeof e===l&&e>0}},parentNode:{getter:function(t){return t instanceof i||e.one(t||s)||e.one(s)},validator:function(e){return e instanceof i||typeof e===N}},textTransform:{value:E,validator:function(e){return e===null||e===w||e===E||e===S}},readyText:{value:"ready",validator:function(e){return e===null||typeof e===N}},showIcon:{value:!0,validator:function(e){return typeof e===T}},statusSpin:{value:"itsaicon-controll-spin6",validator:function(e){return typeof e===N}}}}),_.prototype.initializer=function(){var t=this;t._eventhandlers=[],t._bars={},t.simpleMessages=!0,t._renderBars(),e.later(b,t,t.isReady)},_.prototype.isReady=function(){var t=this;return t._readyPromise||(t._readyPromise=e.usePromise("gallery-itsanodepromise","gallerycss-itsa-base","gallerycss-itsa-animatespin","gallerycss-itsa-controll","gallerycss-itsa-dialog"))},_.prototype.resurrect=function(e){var t=this;t.isReady().then(function(){var n=t._bars[e.level];n&&n.showPromise()})},_.prototype.suspend=function(e){var t=this;t.isReady().then(function(){var n=t._bars[e.level];n&&n.hidePromise()})},_.prototype.viewMessage=function(t){var n=this;return n.isReady().then(function(){return new e.Promise(function(r){var i=n._bars,s=i[t.level];n._hideBar(i[f]),n._showBar(s,t).then(function(){return t._promise}).then(function(){return n._hideBar(s,!0)},function(){return n._hideBar(s,!0)}).then(function(){r(),n.countMessages(!0)===0&&i[f].show()&&i[f].setStyle("opacity",1)}).then(null,function(t){e.soon(function(){throw t})})})})},_.prototype.destructor=function(){var e=this;e._clearEventhandlers(),e._bars.destroy(!0)},_.prototype._clearEventhandlers=function(){var e=this;n.each(e._eventhandlers,function(e){e.detach()})},_.prototype._hideBar=function(e,t){return t&&e.set("text",""),e.setStyle("opacity",0),e.hide()},_.prototype._renderBars=function(){var t=this,r=t._eventhandlers,s=t.get(g),l,b,x,T,N,C;C=i.create(c),l=t._bars,b=l[f]=i.create(h),x=l[o]=i.create(p),T=l[u]=i.create(d),N=l[a]=i.create(v),t.get("parentNode").prepend(C.append(b).append(x).append(T).append(N)),b.set("text",t.get(L)),s&&C.addClass(m+s),n.each([o,u,a],function(n){r.push(l[n].delegate("tap",function(){var r=t._lastMessage[n];r.resolve(),r._promise.then(e.bind(t._hideBar,t,l[n],!0))},k))}),r.push(t.on(g+y,function(e){var t=e.newVal;C.removeClass(m+w),C.removeClass(m+E),C.removeClass(m+S),t&&C.addClass(m+t)})),r.push(t.on(L+y,function(e){b.set("text",e.newVal)}))},_.prototype._showBar=function(t,n){var i=this,s=i.get("fadeDelay"),u=n.level===o?n._config.icon:n.icon,a;return n.messageType==="showStatus"&&(u=i.get("statusSpin")+" itsa-iconstandalone itsa-busy"),a={icontemplate:u?r.sub(O,{icon:u}):"",message:e.Escape.html(n.message.replace(/<br ?\/?>/g,"x")),button:n.noButtons?"":A},t.setHTML(r.sub(M,a)),n[x]||(s===0?t.show():t.showPromise(null,{duration:s}))}},"@VERSION@",{requires:["yui-base","event-tap","promise","timers","escape","node-event-delegate","node-style","gallery-itsamessageviewer"],skinnable:!0});
